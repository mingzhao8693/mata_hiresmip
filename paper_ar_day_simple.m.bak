%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/archive/Ming.Zhao/backup/ECMWF/';
expn='ERAI_6h_DATA'; ardir='AR_climlmt'; yr1=1979;yr2=2014;
opt='obs'; v=readarmap_day(tpath,expn,yr1,yr2,ardir,opt);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/archive/Ming.Zhao/awg/warsaw_201803/';pct=[99 99.9];%pct=[25 50 75 90 95 99 99.9];
expn='c192L33_am4p0_amip_HIRESMIP_H8_newpp'; ardir='AR_climlmt';yr1=1979;yr2=2014;
opt='mod'; v=readarmap_allday(tpath,expn,yr1,yr2,pct,opt);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/archive/Ming.Zhao/awg/warsaw_201803/';pct=[99 99.9];%pct=[25 50 75 90 95 99 99.9];
expn='c192L33_am4p0_amip_HIRESMIP_future_ssp585_newpp'; ardir='AR_climlmt';yr1=2015;yr2=2050;
opt='mod'; v=readarmap_allday(tpath,expn,yr1,yr2,pct,opt);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/archive/Ming.Zhao/awg/warsaw_201803/';pct=[99 99.9];%pct=[25 50 75 90 95 99 99.9];
expn='c192L33_am4p0_2010climo_new_newpp'; ardir='AR_climlmt'; yr1=2;yr2=101;diag=4;
%v=readar_limit_new(tpath,expn,yr1,yr2,ardir);
%opt='mod'; addtc_to_AR(tpath,expn,yr1,yr2,opt,-50)
opt='AR';  v.ar=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='TC';  v.tc=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='TD';  v.td=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='MC';  v.mc=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
%opt='mod'; v=readarmap_allday(tpath,expn,yr1,yr2,pct,opt);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/archive/Ming.Zhao/awg/warsaw_201803/';pct=[99 99.9];%pct=[25 50 75 90 95 99 99.9];
expn='c192L33_am4p0_2010climo_new_p4K_newpp'; ardir='AR_climlmt';yr1=2;yr2=101;diag=4;
%v=readar_limit_new(tpath,expn,yr1,yr2,ardir);
%opt='mod'; addtc_to_AR(tpath,expn,yr1,yr2,opt,-50)
opt='AR';  v.ar=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='TC';  v.tc=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='TD';  v.td=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='MC';  v.mc=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
%opt='mod'; v=readarmap_allday(tpath,expn,yr1,yr2,pct,opt);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/archive/Ming.Zhao/awg/warsaw_201803/';pct=[99 99.9];%pct=[25 50 75 90 95 99 99.9];
expn='c192L33_am4p0_2010climo_new_p4K_4xCO2_newpp'; ardir='AR_climlmt';yr1=2;yr2=101;diag=4;
%v=readar_limit_new(tpath,expn,yr1,yr2,ardir);
%opt='mod'; addtc_to_AR(tpath,expn,yr1,yr2,opt,-50)
opt='AR';  v.ar =readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='TC';  v.tc =readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='TD';  v.td =readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='MC';  v.msc=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
%opt='mod'; v=readarmap_allday(tpath,expn,yr1,yr2,pct,opt,diag);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/archive/Ming.Zhao/awg/warsaw_201803/';pct=[99 99.9];%pct=[25 50 75 90 95 99 99.9];
expn='c192L33_am4p0_2010climo_new_4xCO2_newpp'; ardir='AR_climlmt';yr1=2;yr2=101;diag=4;
%v=readar_limit_new(tpath,expn,yr1,yr2,ardir);
opt='mod'; addtc_to_AR(tpath,expn,yr1,yr2,opt,-50)
opt='AR';  v.ar =readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='TC';  v.tc =readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='TD';  v.td =readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='MC';  v.msc=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
%opt='mod'; v=readarmap_allday(tpath,expn,yr1,yr2,pct,opt,diag);
%v=readar_limit_new(tpath,expn,yr1,yr2,ardir);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/archive/Ming.Zhao/awg/warsaw_201803/';pct=[99 99.9];%pct=[25 50 75 90 95 99 99.9];
expn='c192L33_am4p0_climo_hiresmip_futureSST_4xCO2_newpp'; ardir='AR_climlmt';yr1=2;yr2=101;diag=4;
%v=readar_limit_new(tpath,expn,yr1,yr2,ardir);
opt='mod'; addtc_to_AR(tpath,expn,yr1,yr2,opt,-50)
opt='AR';  v.ar =readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='TC';  v.tc =readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='TD';  v.td =readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
opt='MC';  v.msc=readartc_day(tpath,expn,yr1,yr2,pct,opt,diag);
%v=readar_limit_new(tpath,expn,yr1,yr2,ardir);
%opt='mod'; v=readarmap_allday(tpath,expn,yr1,yr2,pct,opt);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Analysis
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/work/miz/mat_hiresmip/';
expn='c192L33_am4p0_amip_HIRESMIP_H8_newpp'; yrs='_1979_2014_';ardir='AR_climlmt'
fext=strcat(yrs,'readarmap_allday1.mat'); fn=strcat(tpath,expn,fext); load(fn);vm=v;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/work/miz/mat_hiresmip/';
expn='c192L33_am4p0_amip_HIRESMIP_future_ssp585_newpp'; yrs='_2015_2050_';ardir='AR_climlmt'
fext=strcat(yrs,'readarmap_allday1.mat'); fn=strcat(tpath,expn,fext); load(fn);wm=v;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/work/miz/mat_hiresmip/'; d=4;
expn='c192L33_am4p0_2010climo_new_newpp'; yrs='_2_101_';ardir='AR_climlmt'
fext=strcat(yrs,'AR_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);v1.ar=v;
fext=strcat(yrs,'TC_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);v1.tc=v;
fext=strcat(yrs,'TD_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);v1.td=v;
fext=strcat(yrs,'MC_diag',num2str(d),'_readartc_day_newmc.mat'); fn=strcat(tpath,expn,fext); load(fn);v1.mc=v;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/work/miz/mat_hiresmip/'; d=4;
expn='c192L33_am4p0_2010climo_new_p4K_newpp'; yrs='_2_101_';ardir='AR_climlmt'
fext=strcat(yrs,'AR_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w1.ar=v;
fext=strcat(yrs,'TC_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w1.tc=v;
fext=strcat(yrs,'TD_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w1.td=v;
fext=strcat(yrs,'MC_diag',num2str(d),'_readartc_day_newmc.mat'); fn=strcat(tpath,expn,fext); load(fn);w1.mc=v;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/work/miz/mat_hiresmip/'; d=4;
expn='c192L33_am4p0_2010climo_new_p4K_4xCO2_newpp'; yrs='_2_101_';ardir='AR_climlmt'
fext=strcat(yrs,'AR_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w2.ar=v;
fext=strcat(yrs,'TC_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w2.tc=v;
fext=strcat(yrs,'TD_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w2.td=v;
fext=strcat(yrs,'MC_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w2.mc=v;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/work/miz/mat_hiresmip/'; d=4;
expn='c192L33_am4p0_2010climo_new_4xCO2_newpp'; yrs='_2_101_';ardir='AR_climlmt'
fext=strcat(yrs,'AR_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);g1.ar=v;
fext=strcat(yrs,'TC_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);g1.tc=v;
fext=strcat(yrs,'TD_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);g1.td=v;
fext=strcat(yrs,'MC_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);g1.mc=v;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tpath='/work/miz/mat_hiresmip/'; d=4;
expn='c192L33_am4p0_climo_hiresmip_futureSST_4xCO2_newpp'; yrs='_2_101_';ardir='AR_climlmt'
fext=strcat(yrs,'AR_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w3.ar=v;
fext=strcat(yrs,'TC_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w3.tc=v;
fext=strcat(yrs,'TD_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w3.td=v;
fext=strcat(yrs,'MC_diag',num2str(d),'_readartc_day.mat'); fn=strcat(tpath,expn,fext); load(fn);w3.mc=v;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: AGU presentation a short paper to be drafted
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 1: AR/TS/TD/MSC days (frequency)%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %occurrence frequency: fraction of all days
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='frqday'; p.xy=[0 360 -90 90]; 
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.prday_fqwet(1,:,:,2));
p.z2=squeeze(v1.ar.frqday);   
p.z3=squeeze(v1.tc.frqday);
p.z4=squeeze(v1.td.frqday);
p.z5=squeeze(v1.mc.frqday);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) frequency of wet day';
p.s2='(c) frequency of AR days'; 
p.s3='(d) frequency of TS days'; 
p.s4='(e) frequency of TD days'; 
p.s5='(f) frequency of MCS days';
p.s6='(b) frequency of AR+TS+TD+MCS days'; p.s0='';
p.c1=[0 1]; a=[0 0.4]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=[0 1];
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 2: fraction of extreme precip from AR/TS/TD/MSC conditions%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %fraction of P>P99 from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='prday_fp99_from_id'; p.xy=[0 360 -90 90];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.prday_pct(:,1,:,:));
p.z2=squeeze(v1.ar.prday_fp99_from_id);   
p.z3=squeeze(v1.tc.prday_fp99_from_id);
p.z4=squeeze(v1.td.prday_fp99_from_id);
p.z5=squeeze(v1.mc.prday_fp99_from_id);
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) 99 percentile of daily precipitation';
p.s2='(c) fraction from AR'; 
p.s3='(d) fraction from TS'; 
p.s4='(e) fraction from TD'; 
p.s5='(f) fraction from MCS';
p.s6='(b) fraction from AR+TS+TD+MCS'; p.s0='';
p.c1=[0 100]; a=[0 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 3: annual mean precip contributed from AR/TS/TD/MSC %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %all time mean prday from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='prday_idwei'; p.xy=[0 360 -90 90];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.prday_av);   
p.z2=squeeze(v1.ar.prday_idwei);   
p.z3=squeeze(v1.tc.prday_idwei); 
p.z4=squeeze(v1.td.prday_idwei);
p.z5=squeeze(v1.mc.prday_idwei);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) annual mean precipitation Pr';
p.s2='(c) annual mean Pr from AR'; 
p.s3='(d) annual mean Pr from TS'; 
p.s4='(e) annual mean Pr from TD'; 
p.s5='(f) annual mean Pr from MCS';
p.s6='(b) annual mean Pr from AR+TS+TD+MCS'; p.s0='';
p.c1=[0 10]; p.c2=[0 3]; p.c3=[0 3]; p.c4=[0 3]; p.c5=[0 6]; p.c6=[0 10]; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 4: annual mean LW CRE contributed from AR/TS/TD/MSC %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %all time mean lwcf from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='lwcf_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=2;p.nn=128; p.c='k';
p.z1=squeeze(v1.ar.lwcf_av);
p.z2=squeeze(v1.ar.lwcf_idwei);   
p.z3=squeeze(v1.tc.lwcf_idwei);
p.z4=squeeze(v1.td.lwcf_idwei);
p.z5=squeeze(v1.mc.lwcf_idwei);
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) LW CRF';
p.s2='(c) LW CRE from AR'; 
p.s3='(d) LW CRE from TS'; 
p.s4='(e) LW CRE from TD'; 
p.s5='(f) LW CRE from MCS';
p.s6='(b) LW CRE from AR+TS+TD+MCS'; p.s0='';
p.c1=[-60 60]; a=[-30 30]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=p.c1;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 5: annual mean SW CRE contributed from AR/TS/TD/MSC %%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %all time mean swcf from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='swcf_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=2;p.nn=128; p.c='k';
p.z1=squeeze(v1.ar.swcf_av);
p.z2=squeeze(v1.ar.swcf_idwei);   
p.z3=squeeze(v1.tc.swcf_idwei);
p.z4=squeeze(v1.td.swcf_idwei);
p.z5=squeeze(v1.mc.swcf_idwei);
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) SW CRE';
p.s2='(c) SW CRE from AR'; 
p.s3='(d) SW CRE from TS'; 
p.s4='(e) SW CRE from TD'; 
p.s5='(f) SW CRE from MCS';
p.s6='(b) SW CRE from AR+TS+TD+MCS'; p.s0='';
p.c1=[-100 100]; a=[-30 30]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a*2;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 6: annual mean total CRE contributed from AR/TS/TD/MSC %%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %all time mean swcf from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='ttcf_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=2;p.nn=128; p.c='k';
v=v1.ar; p.z1=squeeze(v.swcf_av+v.lwcf_av);
v=v1.ar; p.z2=squeeze(v.swcf_idwei+v.lwcf_idwei);
v=v1.tc; p.z3=squeeze(v.swcf_idwei+v.lwcf_idwei);
v=v1.td; p.z4=squeeze(v.swcf_idwei+v.lwcf_idwei);
v=v1.mc; p.z5=squeeze(v.swcf_idwei+v.lwcf_idwei);
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) total CRE';
p.s2='(c) total CRE from AR'; 
p.s3='(d) total CRE from TS'; 
p.s4='(e) total CRE from TD'; 
p.s5='(f) total CRE from MCS';
p.s6='(b) total CRE from AR+TS+TD+MCS'; p.s0='';
p.c1=[-100 100]; a=[-20 20]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=p.c1*0.4;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 7: Precipitation averaged only over AR/TS/TD/MSC conditions%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %weather type mean prday
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='prday_idavg'; p.xy=[0 360 -90 90]; 
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=128; p.c='k';
p.z1=squeeze(v1.ar.prday_av); p.z0=p.z1; no=20;
v=v1.ar; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
[p.z2]=compute_se(a1,s1,n1,no);
v=v1.tc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
[p.z3]=compute_se(a1,s1,n1,no);
v=v1.td; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
[p.z4]=compute_se(a1,s1,n1,no);
v=v1.mc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
[p.z5]=compute_se(a1,s1,n1,no);
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) annual mean precipitation, Pr (mm/day)';
p.s2='(c) Pr averaged over AR conditions'; 
p.s3='(d) Pr averaged over TS conditions'; 
p.s4='(e) Pr averaged over TD conditions'; 
p.s5='(f) Pr averaged over MCS conditions';
p.s6='(b) Pr averaged over AR+TS+TD+MCS conditions'; p.s0='';
p.c1=[0 15]; a=[0 15]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) Pr averaged over AR conditions'; 
p.s3='(b) Pr averaged over TS conditions'; 
p.s4='(c) Pr averaged over TD conditions'; 
p.s5='(d) Pr averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 8: LW CRE averaged only over AR/TS/TD/MSC conditions%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %weather type mean lwcf
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='lwcf_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=4;p.nn=128; p.c='k';
p.z1=squeeze(v1.ar.lwcf_av); p.z0=p.z1; no=20;
v=v1.ar; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); 
[p.z2]=compute_se(a1,s1,n1,no);
v=v1.tc; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); 
[p.z3]=compute_se(a1,s1,n1,no);
v=v1.td; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); 
[p.z4]=compute_se(a1,s1,n1,no);
v=v1.mc; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); 
[p.z5]=compute_se(a1,s1,n1,no);
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) annual mean LW CRE (W/m2)';
p.s2='(c) LW CRE averaged over AR conditions'; 
p.s3='(d) LW CRE averaged over TS conditions'; 
p.s4='(e) LW CRE averaged over TD conditions'; 
p.s5='(f) LW CRE averaged over MCS conditions';
p.s6='(b) LW CRE averaged over AR+TS+TD+MCS conditions'; p.s0='';
p.c1=[-100 100]; a=[-100 100]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) LW CRE averaged over AR conditions'; 
p.s3='(b) LW CRE averaged over TS conditions'; 
p.s4='(c) LW CRE averaged over TD conditions'; 
p.s5='(d) LW CRE averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 9: SW CRE averaged only over AR/TS/TD/MSC conditions%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='swcf_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1];p.opt=4;p.nn=128; p.c='k';
p.z1=squeeze(v1.ar.swcf_av); p.z0=p.z1; no=20;
v=v1.ar; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
[p.z2]=compute_se(a1,s1,n1,no);
v=v1.tc; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
[p.z3]=compute_se(a1,s1,n1,no);
v=v1.td; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
[p.z4]=compute_se(a1,s1,n1,no);
v=v1.mc; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
[p.z5]=compute_se(a1,s1,n1,no);
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) annual mean SW CRE (W/m2)';
p.s2='(c) SW CRE averaged over AR conditions'; 
p.s3='(d) SW CRE averaged over TS conditions'; 
p.s4='(e) SW CRE averaged over TD conditions'; 
p.s5='(f) SW CRE averaged over MCS conditions';
p.s6='(b) SW CRE averaged over AR+TS+TD+MCS conditions'; p.s0='';
p.c1=[-200 200]; a=[-200 200]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) SW CRE averaged over AR conditions'; 
p.s3='(b) SW CRE averaged over TS conditions'; 
p.s4='(c) SW CRE averaged over TD conditions'; 
p.s5='(d) SW CRE averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 10: Total CRE averaged only over AR/TS/TD/MSC conditions%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; 
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='ttcf_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1];p.opt=4;p.nn=128; p.c='k';
p.z1=squeeze(v1.ar.swcf_av+v1.ar.lwcf_av); p.z0=p.z1; no=20;
v=v1.ar; p.z2=squeeze(v.swcf_idavg+v.lwcf_idavg); n=squeeze(v.id_sum); p.z2(n<no)=NaN;
v=v1.tc; p.z3=squeeze(v.swcf_idavg+v.lwcf_idavg); n=squeeze(v.id_sum); p.z3(n<no)=NaN;
v=v1.td; p.z4=squeeze(v.swcf_idavg+v.lwcf_idavg); n=squeeze(v.id_sum); p.z4(n<no)=NaN;
v=v1.mc; p.z5=squeeze(v.swcf_idavg+v.lwcf_idavg); n=squeeze(v.id_sum); p.z5(n<no)=NaN;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) annual mean total CRE (W/m2)';
p.s2='(c) total CRE averaged over AR conditions'; 
p.s3='(d) total CRE averaged over TS conditions'; 
p.s4='(e) total CRE averaged over TD conditions'; 
p.s5='(f) total CRE averaged over MCS conditions';
p.s6='(b) total CRE averaged over AR+TS+TD+MCS conditions'; p.s0='';
p.c1=[-100 100]; a=[-100 100]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) total CRE averaged over AR conditions'; 
p.s3='(b) total CRE averaged over TS conditions'; 
p.s4='(c) total CRE averaged over TD conditions'; 
p.s5='(d) total CRE averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%p4K minus Ctl
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 11 Absolute change in frequency of AR/TS/TD/MSC days%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_frqday';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-0.1: 0.005: 0.1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a1=squeeze(v1.ar.prday_fqwet(1,:,:,2)); b1=miznanmean(a1,p.id,p.aa,p.opt)
a2=squeeze(w1.ar.prday_fqwet(1,:,:,2)); b2=miznanmean(a2,p.id,p.aa,p.opt)
p.z1=(a2-a1)/dTs; p.dz1_mean=(b2-b1)/b1/dTs*100;
a1=squeeze(v1.ar.frqday); b1=miznanmean(a1,p.id,p.aa,p.opt); b1s=b1;
a2=squeeze(w1.ar.frqday); b2=miznanmean(a2,p.id,p.aa,p.opt); b2s=b2;
p.z2=(a2-a1)/dTs; p.dz2_mean=(b2-b1)/b1/dTs*100;
a1=squeeze(v1.tc.frqday); b1=miznanmean(a1,p.id,p.aa,p.opt); b1s=b1s+b1;
a2=squeeze(w1.tc.frqday); b2=miznanmean(a2,p.id,p.aa,p.opt); b2s=b2s+b2;
p.z3=(a2-a1)/dTs; p.dz3_mean=(b2-b1)/b1/dTs*100;
a1=squeeze(v1.td.frqday); b1=miznanmean(a1,p.id,p.aa,p.opt); b1s=b1s+b1;
a2=squeeze(w1.td.frqday); b2=miznanmean(a2,p.id,p.aa,p.opt); b2s=b2s+b2;
p.z4=(a2-a1)/dTs; p.dz4_mean=(b2-b1)/b1/dTs*100;
a1=squeeze(v1.mc.frqday); b1=miznanmean(a1,p.id,p.aa,p.opt); b1s=b1s+b1;
a2=squeeze(w1.mc.frqday); b2=miznanmean(a2,p.id,p.aa,p.opt); b2s=b2s+b2;
p.z5=(a2-a1)/dTs; p.dz5_mean=(b2-b1)/b1/dTs*100;
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6; p.dz6_mean=(b2s-b1s)/b1s/dTs*100;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='(a) \Delta frequency of wet days';
p.s2='(c) \Delta frequency of AR days'; 
p.s3='(d) \Delta frequency of TS days'; 
p.s4='(e) \Delta frequency of TD days'; 
p.s5='(f) \Delta frequency of MCS days';
p.s6='(b) \Delta AR+TS+TD+MCS days'; p.s0='';
p.c1=[-0.02 0.02]; a=[-0.01 0.01]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=p.c1;
plot_2d_6panel(p)
p.s2='(a) \Delta frequency of AR days'; 
p.s3='(b) \Delta frequency of TS days'; 
p.s4='(c) \Delta frequency of TD days'; 
p.s5='(d) \Delta frequency of MCS days';
p.c1=[-0.02 0.02]; a=[-0.01 0.01]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=p.c1;
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 12 Percentage change in frequency of AR/TS/TD/MSC days%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_frqday_percent';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-0.1: 0.005: 0.1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=0.001;
a1=squeeze(v1.ar.prday_fqwet(1,:,:,2)); b1=miznanmean(a1,p.id,p.aa,p.opt)
a2=squeeze(w1.ar.prday_fqwet(1,:,:,2)); b2=miznanmean(a2,p.id,p.aa,p.opt)
p.z1=(a2-a1)./a1*100/dTs; p.dz1_mean=(b2-b1)/b1/dTs*100;
p.z1(a1<no |a2<no)=NaN;
a1=squeeze(v1.ar.frqday); b1=miznanmean(a1,p.id,p.aa,p.opt); b1s=b1;a1s=a1;
a2=squeeze(w1.ar.frqday); b2=miznanmean(a2,p.id,p.aa,p.opt); b2s=b2;a2s=a2;
p.z2=(a2-a1)./a1*100/dTs; p.dz2_mean=(b2-b1)/b1/dTs*100;
p.z2(a1<no |a2<no)=NaN;
a1=squeeze(v1.tc.frqday); b1=miznanmean(a1,p.id,p.aa,p.opt); b1s=b1s+b1;a1s=a1s+a1;
a2=squeeze(w1.tc.frqday); b2=miznanmean(a2,p.id,p.aa,p.opt); b2s=b2s+b2;a2s=a2s+a2;
p.z3=(a2-a1)./a1*100/dTs; p.dz3_mean=(b2-b1)/b1/dTs*100;
p.z3(a1<no |a2<no)=NaN;
a1=squeeze(v1.td.frqday); b1=miznanmean(a1,p.id,p.aa,p.opt); b1s=b1s+b1;a1s=a1s+a1;
a2=squeeze(w1.td.frqday); b2=miznanmean(a2,p.id,p.aa,p.opt); b2s=b2s+b2;a2s=a2s+a2;
p.z4=(a2-a1)./a1*100/dTs; p.dz4_mean=(b2-b1)/b1/dTs*100;
p.z4(a1<no |a2<no)=NaN;
a1=squeeze(v1.mc.frqday); b1=miznanmean(a1,p.id,p.aa,p.opt); b1s=b1s+b1;a1s=a1s+a1;
a2=squeeze(w1.mc.frqday); b2=miznanmean(a2,p.id,p.aa,p.opt); b2s=b2s+b2;a2s=a2s+a2;
p.z5=(a2-a1)./a1*100/dTs; p.dz5_mean=(b2-b1)/b1/dTs*100;
p.z5(a1<no |a2<no)=NaN;
p.z6=(a2s-a1s)./a1s*100/dTs; p.dz6_mean=(b2s-b1s)/b1s/dTs*100;
p.z6(a1s<no |a2s<no)=NaN; p.z0=p.z6;
%p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6; 
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='(a) \Delta frequency of wet days';
p.s2='(c) \Delta frequency of AR days'; 
p.s3='(d) \Delta frequency of TS days'; 
p.s4='(e) \Delta frequency of TD days'; 
p.s5='(f) \Delta frequency of MCS days';
p.s6='(b) \Delta AR+TS+TD+MCS days'; p.s0='';
p.c1=[-20 20]; a=[-20 20]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=p.c1;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 13 change in annual mean Pr contributed from AR/TS/TD/MSC%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
p.z1=squeeze(w1.ar.prday_av   -v1.ar.prday_av)/dTs;
p.z2=squeeze(w1.ar.prday_idwei-v1.ar.prday_idwei)/dTs;   
p.z3=squeeze(w1.tc.prday_idwei-v1.tc.prday_idwei)/dTs;
p.z4=squeeze(w1.td.prday_idwei-v1.td.prday_idwei)/dTs;
p.z5=squeeze(w1.mc.prday_idwei-v1.mc.prday_idwei)/dTs;    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean precipitation';
p.s2='(c) \Delta AR precipitation'; 
p.s3='(d) \Delta TS precipitation'; 
p.s4='(e) \Delta TD precipitation'; 
p.s5='(f) \Delta MCS precipitation';
p.s6='(b) \Delta AR+TS+TD+MCS precipitation'; p.s0='';
p.c1=[-0.4 0.4]; a=[-0.2 0.2]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=[-0.4 0.4]; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 14 change in annual mean LW CRE contributed from AR/TS/TD/MSC
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_lwcf_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a =squeeze(w1.ar.lwcf_av);    b =squeeze(v1.ar.lwcf_av);    p.z1=(a-b)/dTs;
a =squeeze(w1.ar.lwcf_idwei); b =squeeze(v1.ar.lwcf_idwei); p.z2=(a-b)/dTs;
a =squeeze(w1.tc.lwcf_idwei); b =squeeze(v1.tc.lwcf_idwei); p.z3=(a-b)/dTs;
a =squeeze(w1.td.lwcf_idwei); b =squeeze(v1.td.lwcf_idwei); p.z4=(a-b)/dTs;
a =squeeze(w1.mc.lwcf_idwei); b =squeeze(v1.mc.lwcf_idwei); p.z5=(a-b)/dTs;
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean LW CRE';
p.s2='(c) \Delta AR LW CRE'; 
p.s3='(d) \Delta TS LW CRE'; 
p.s4='(e) \Delta TD LW CRE'; 
p.s5='(f) \Delta MCS LW CRE';
p.s6='(b) \Delta LW CRE from AR+TS+TD+MCS'; p.s0='';
p.c1=[-2 2]; a=[-1 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=p.c1; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 15 change in annual mean SW CRE contributed from AR/TS/TD/MSC
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_swcf_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a =squeeze(w1.ar.swcf_av);    b =squeeze(v1.ar.swcf_av);    p.z1=(a-b)/dTs;
a =squeeze(w1.ar.swcf_idwei); b =squeeze(v1.ar.swcf_idwei); p.z2=(a-b)/dTs;
a =squeeze(w1.tc.swcf_idwei); b =squeeze(v1.tc.swcf_idwei); p.z3=(a-b)/dTs;
a =squeeze(w1.td.swcf_idwei); b =squeeze(v1.td.swcf_idwei); p.z4=(a-b)/dTs;
a =squeeze(w1.mc.swcf_idwei); b =squeeze(v1.mc.swcf_idwei); p.z5=(a-b)/dTs;
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean SW CRE';
p.s2='(c) \Delta AR SW CRE'; 
p.s3='(d) \Delta TS SW CRE'; 
p.s4='(e) \Delta TD SW CRE'; 
p.s5='(f) \Delta MCS SW CRE';
p.s6='(b) \Delta SW CRE from AR+TS+TD+MCS'; p.s0='';
p.c1=[-2 2]; a=[-1 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=p.c1; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 16 change in annual mean total CRE contributed from AR/TS/TD/MSC
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_ttcf_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
v=v1.ar; a1=squeeze(v.swcf_av+v.lwcf_av);
v=w1.ar; a2=squeeze(v.swcf_av+v.lwcf_av);       p.z1=(a2-a1)/dTs;
v=v1.ar; a1=squeeze(v.swcf_idwei+v.lwcf_idwei);
v=w1.ar; a2=squeeze(v.swcf_idwei+v.lwcf_idwei); p.z2=(a2-a1)/dTs;
v=v1.tc; a1=squeeze(v.swcf_idwei+v.lwcf_idwei);
v=w1.tc; a2=squeeze(v.swcf_idwei+v.lwcf_idwei); p.z3=(a2-a1)/dTs;
v=v1.td; a1=squeeze(v.swcf_idwei+v.lwcf_idwei);
v=w1.td; a2=squeeze(v.swcf_idwei+v.lwcf_idwei); p.z4=(a2-a1)/dTs;
v=v1.mc; a1=squeeze(v.swcf_idwei+v.lwcf_idwei);
v=w1.mc; a2=squeeze(v.swcf_idwei+v.lwcf_idwei); p.z5=(a2-a1)/dTs;
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean total CRE';
p.s2='(c) \Delta AR total CRE'; 
p.s3='(d) \Delta TS total CRE'; 
p.s4='(e) \Delta TD total CRE'; 
p.s5='(f) \Delta MCS total CRE';
p.s6='(b) \Delta total CRE from AR+TS+TD+MCS'; p.s0='';
p.c1=[-2 2]; a=[-1 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=p.c1; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 17: change in Pr averaged only over AR/TS/TD/MSC conditions%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=128; p.c='k'; dTs=4.52; no=20;
v=v1.ar; a1=squeeze(v.prday_av); %s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prday_av); %s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); a1_ar=a1;n1_ar=n1;
v=w1.ar; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); a2_ar=a2;n2_ar=n2;
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); a1_tc=a1;n1_tc=n1;
v=w1.tc; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); a2_tc=a2;n2_tc=n2;
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); a1_td=a1;n1_td=n1;
v=w1.td; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); a2_td=a2;n2_td=n2;
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); a1_mc=a1;n1_mc=n1;
v=w1.mc; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); a2_mc=a2;n2_mc=n2;
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
idx=isnan(a1_ar); a1_ar(idx)=0; n1_ar(idx)=0;
idx=isnan(a1_tc); a1_tc(idx)=0; n1_tc(idx)=0;
idx=isnan(a1_td); a1_td(idx)=0; n1_td(idx)=0;
idx=isnan(a1_mc); a1_mc(idx)=0; n1_mc(idx)=0;
idx=isnan(a2_ar); a2_ar(idx)=0; n2_ar(idx)=0;
idx=isnan(a2_tc); a2_tc(idx)=0; n2_tc(idx)=0;
idx=isnan(a2_td); a2_td(idx)=0; n2_td(idx)=0;
idx=isnan(a2_mc); a2_mc(idx)=0; n2_mc(idx)=0;
a1=(a1_ar.*n1_ar+a1_tc.*n1_tc+a1_td.*n1_td+a1_mc.*n1_mc)./(n1_ar+n1_tc+n1_td+n1_mc);
a2=(a2_ar.*n2_ar+a2_tc.*n2_tc+a2_td.*n2_td+a2_mc.*n2_mc)./(n2_ar+n2_tc+n2_td+n2_mc);
p.z6=(a2-a1)./a1*100/dTs; p.z0=p.z6;
%clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean precipitation';
p.s2='(c) \DeltaPr averaged over AR conditions'; 
p.s3='(d) \DeltaPr averaged over TS conditions'; 
p.s4='(e) \DeltaPr averaged over TD conditions'; 
p.s5='(f) \DeltaPr averaged over MCS conditions';
p.s6='(b) \DeltaPr averaged over AR+TS+TD+MCS conditions'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) \DeltaPr averaged over AR conditions'; 
p.s3='(b) \DeltaPr averaged over TS conditions'; 
p.s4='(c) \DeltaPr averaged over TD conditions'; 
p.s5='(d) \DeltaPr averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 18: change in omega 500 averaged only over AR/TS/TD/MSC conditions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_w500_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=128; p.c='k'; dTs=4.52; no=20;
v=v1.ar; a1=squeeze(v.w500_av); %s1=squeeze(v.w500_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.w500_av); %s2=squeeze(v.w500_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.w500_idavg); s1=squeeze(v.w500_idstd); n1=squeeze(v.id_sum); a1_ar=a1;n1_ar=n1;
v=w1.ar; a2=squeeze(v.w500_idavg); s2=squeeze(v.w500_idstd); n2=squeeze(v.id_sum); a2_ar=a2;n2_ar=n2;
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.w500_idavg); s1=squeeze(v.w500_idstd); n1=squeeze(v.id_sum); a1_tc=a1;n1_tc=n1;
v=w1.tc; a2=squeeze(v.w500_idavg); s2=squeeze(v.w500_idstd); n2=squeeze(v.id_sum); a2_tc=a2;n2_tc=n2;
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.w500_idavg); s1=squeeze(v.w500_idstd); n1=squeeze(v.id_sum); a1_td=a1;n1_td=n1;
v=w1.td; a2=squeeze(v.w500_idavg); s2=squeeze(v.w500_idstd); n2=squeeze(v.id_sum); a2_td=a2;n2_td=n2;
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.w500_idavg); s1=squeeze(v.w500_idstd); n1=squeeze(v.id_sum); a1_mc=a1;n1_mc=n1;
v=w1.mc; a2=squeeze(v.w500_idavg); s2=squeeze(v.w500_idstd); n2=squeeze(v.id_sum); a2_mc=a2;n2_mc=n2;
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;
idx=isnan(a1_ar); a1_ar(idx)=0; n1_ar(idx)=0;
idx=isnan(a1_tc); a1_tc(idx)=0; n1_tc(idx)=0;
idx=isnan(a1_td); a1_td(idx)=0; n1_td(idx)=0;
idx=isnan(a1_mc); a1_mc(idx)=0; n1_mc(idx)=0;
idx=isnan(a2_ar); a2_ar(idx)=0; n2_ar(idx)=0;
idx=isnan(a2_tc); a2_tc(idx)=0; n2_tc(idx)=0;
idx=isnan(a2_td); a2_td(idx)=0; n2_td(idx)=0;
idx=isnan(a2_mc); a2_mc(idx)=0; n2_mc(idx)=0;
a1=(a1_ar.*n1_ar+a1_tc.*n1_tc+a1_td.*n1_td+a1_mc.*n1_mc)./(n1_ar+n1_tc+n1_td+n1_mc);
a2=(a2_ar.*n2_ar+a2_tc.*n2_tc+a2_td.*n2_td+a2_mc.*n2_mc)./(n2_ar+n2_tc+n2_td+n2_mc);
p.z6=(a2-a1)./a1*100/dTs; p.z0=p.z6;
%clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean \omega_{500}';
p.s2='(a) \Delta\omega_{500} averaged over AR conditions'; 
p.s3='(b) \Delta\omega_{500} averaged over TS conditions'; 
p.s4='(c) \Delta\omega_{500} averaged over TD conditions'; 
p.s5='(d) \Delta\omega_{500} averaged over MCS conditions';
p.s6='(b) \Delta\omega_{500} over AR+TS+TD+MCS'; p.s0='';
p.c1=[-5 5]; a=[-5 5]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) \Delta\omega_{500} averaged over AR conditions'; 
p.s3='(b) \Delta\omega_{500} averaged over TS conditions'; 
p.s4='(c) \Delta\omega_{500} averaged over TD conditions'; 
p.s5='(d) \Delta\omega_{500} averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 19: change in prw averaged only over AR/TS/TD/MSC conditions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prw_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=4; p.nn=128; p.c='k'; dTs=4.52; no=20;
v=v1.ar; a1=squeeze(v.prw_av); %s1=squeeze(v.prw_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prw_av); %s2=squeeze(v.prw_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.prw_idavg); s1=squeeze(v.prw_idstd); n1=squeeze(v.id_sum); a1_ar=a1;n1_ar=n1;
v=w1.ar; a2=squeeze(v.prw_idavg); s2=squeeze(v.prw_idstd); n2=squeeze(v.id_sum); a2_ar=a2;n2_ar=n2;
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prw_idavg); s1=squeeze(v.prw_idstd); n1=squeeze(v.id_sum); a1_tc=a1;n1_tc=n1;
v=w1.tc; a2=squeeze(v.prw_idavg); s2=squeeze(v.prw_idstd); n2=squeeze(v.id_sum); a2_tc=a2;n2_tc=n2;
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prw_idavg); s1=squeeze(v.prw_idstd); n1=squeeze(v.id_sum); a1_td=a1;n1_td=n1;
v=w1.td; a2=squeeze(v.prw_idavg); s2=squeeze(v.prw_idstd); n2=squeeze(v.id_sum); a2_td=a2;n2_td=n2;
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prw_idavg); s1=squeeze(v.prw_idstd); n1=squeeze(v.id_sum); a1_mc=a1;n1_mc=n1;
v=w1.mc; a2=squeeze(v.prw_idavg); s2=squeeze(v.prw_idstd); n2=squeeze(v.id_sum); a2_mc=a2;n2_mc=n2;
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
idx=isnan(a1_ar); a1_ar(idx)=0; n1_ar(idx)=0;
idx=isnan(a1_tc); a1_tc(idx)=0; n1_tc(idx)=0;
idx=isnan(a1_td); a1_td(idx)=0; n1_td(idx)=0;
idx=isnan(a1_mc); a1_mc(idx)=0; n1_mc(idx)=0;
idx=isnan(a2_ar); a2_ar(idx)=0; n2_ar(idx)=0;
idx=isnan(a2_tc); a2_tc(idx)=0; n2_tc(idx)=0;
idx=isnan(a2_td); a2_td(idx)=0; n2_td(idx)=0;
idx=isnan(a2_mc); a2_mc(idx)=0; n2_mc(idx)=0;
a1=(a1_ar.*n1_ar+a1_tc.*n1_tc+a1_td.*n1_td+a1_mc.*n1_mc)./(n1_ar+n1_tc+n1_td+n1_mc);
a2=(a2_ar.*n2_ar+a2_tc.*n2_tc+a2_td.*n2_td+a2_mc.*n2_mc)./(n2_ar+n2_tc+n2_td+n2_mc);
p.z6=(a2-a1)./a1*100/dTs; p.z0=p.z6;
%clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean PRW';
p.s2='(c) \Delta AR mean PRW'; 
p.s3='(d) \Delta TS mean PRW'; 
p.s4='(e) \Delta TD mean PRW'; 
p.s5='(f) \Delta MCS mean PRW';
p.s6='(b) \Delta AR+TS+TD+MCS PRW'; p.s0='';
p.c1=[0 12]; a=[0 12]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) \DeltaPRW averaged over AR conditions'; 
p.s3='(b) \DeltaPRW averaged over TS conditions'; 
p.s4='(c) \DeltaPRW averaged over TD conditions'; 
p.s5='(d) \DeltaPRW averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 20: change in q850 averaged only over AR/TS/TD/MSC conditions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_q850_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=4; p.nn=128; p.c='k'; dTs=4.52; no=20;
v=v1.ar; a1=squeeze(v.q850_av); %s1=squeeze(v.q850_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.q850_av); %s2=squeeze(v.q850_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.q850_idavg); s1=squeeze(v.q850_idstd); n1=squeeze(v.id_sum); a1_ar=a1;n1_ar=n1;
v=w1.ar; a2=squeeze(v.q850_idavg); s2=squeeze(v.q850_idstd); n2=squeeze(v.id_sum); a2_ar=a2;n2_ar=n2;
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.q850_idavg); s1=squeeze(v.q850_idstd); n1=squeeze(v.id_sum); a1_tc=a1;n1_tc=n1;
v=w1.tc; a2=squeeze(v.q850_idavg); s2=squeeze(v.q850_idstd); n2=squeeze(v.id_sum); a2_tc=a2;n2_tc=n2;
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.q850_idavg); s1=squeeze(v.q850_idstd); n1=squeeze(v.id_sum); a1_td=a1;n1_td=n1;
v=w1.td; a2=squeeze(v.q850_idavg); s2=squeeze(v.q850_idstd); n2=squeeze(v.id_sum); a2_td=a2;n2_td=n2;
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.q850_idavg); s1=squeeze(v.q850_idstd); n1=squeeze(v.id_sum); a1_mc=a1;n1_mc=n1;
v=w1.mc; a2=squeeze(v.q850_idavg); s2=squeeze(v.q850_idstd); n2=squeeze(v.id_sum); a2_mc=a2;n2_mc=n2;
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
idx=isnan(a1_ar); a1_ar(idx)=0; n1_ar(idx)=0;
idx=isnan(a1_tc); a1_tc(idx)=0; n1_tc(idx)=0;
idx=isnan(a1_td); a1_td(idx)=0; n1_td(idx)=0;
idx=isnan(a1_mc); a1_mc(idx)=0; n1_mc(idx)=0;
idx=isnan(a2_ar); a2_ar(idx)=0; n2_ar(idx)=0;
idx=isnan(a2_tc); a2_tc(idx)=0; n2_tc(idx)=0;
idx=isnan(a2_td); a2_td(idx)=0; n2_td(idx)=0;
idx=isnan(a2_mc); a2_mc(idx)=0; n2_mc(idx)=0;
a1=(a1_ar.*n1_ar+a1_tc.*n1_tc+a1_td.*n1_td+a1_mc.*n1_mc)./(n1_ar+n1_tc+n1_td+n1_mc);
a2=(a2_ar.*n2_ar+a2_tc.*n2_tc+a2_td.*n2_td+a2_mc.*n2_mc)./(n2_ar+n2_tc+n2_td+n2_mc);
p.z6=(a2-a1)./a1*100/dTs; p.z0=p.z6;
%clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean q_{850}';
p.s2='(c) \Deltaq_{850} averaged over AR conditions'; 
p.s3='(d) \Deltaq_{850} averaged over TS conditions'; 
p.s4='(e) \Deltaq_{850} averaged over TD conditions'; 
p.s5='(f) \Deltaq_{850} averaged over MCS conditions';
p.s6='(b) \Deltaq_{850} over AR+TS+TD+MCS conditions'; p.s0='';
p.c1=[0 12]; a=[0 12]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) \Deltaq_{850} averaged over AR conditions'; 
p.s3='(b) \Deltaq_{850} averaged over TS conditions'; 
p.s4='(c) \Deltaq_{850} averaged over TD conditions'; 
p.s5='(d) \Deltaq_{850} averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 21: change in T850 averaged only over AR/TS/TD/MSC conditions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_t850_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=4; p.nn=128; p.c='k'; dTs=4.52; no=20; dTs=1;
v=v1.ar; a1=squeeze(v.t850_av); %s1=squeeze(v.t850_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.t850_av); %s2=squeeze(v.t850_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)/dTs; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.t850_idavg); s1=squeeze(v.t850_idstd); n1=squeeze(v.id_sum);a1_ar=a1;n1_ar=n1;
v=w1.ar; a2=squeeze(v.t850_idavg); s2=squeeze(v.t850_idstd); n2=squeeze(v.id_sum);a2_ar=a2;n2_ar=n2; 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.t850_idavg); s1=squeeze(v.t850_idstd); n1=squeeze(v.id_sum);a1_tc=a1;n1_tc=n1;
v=w1.tc; a2=squeeze(v.t850_idavg); s2=squeeze(v.t850_idstd); n2=squeeze(v.id_sum);a2_tc=a2;n2_tc=n2;
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;;
v=v1.td; a1=squeeze(v.t850_idavg); s1=squeeze(v.t850_idstd); n1=squeeze(v.id_sum);a1_td=a1;n1_td=n1;
v=w1.td; a2=squeeze(v.t850_idavg); s2=squeeze(v.t850_idstd); n2=squeeze(v.id_sum);a2_td=a2;n2_td=n2;
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;;
v=v1.mc; a1=squeeze(v.t850_idavg); s1=squeeze(v.t850_idstd); n1=squeeze(v.id_sum);a1_mc=a1;n1_mc=n1;
v=w1.mc; a2=squeeze(v.t850_idavg); s2=squeeze(v.t850_idstd); n2=squeeze(v.id_sum);a2_mc=a2;n2_mc=n2;
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;;
idx=isnan(a1_ar); a1_ar(idx)=0; n1_ar(idx)=0;
idx=isnan(a1_tc); a1_tc(idx)=0; n1_tc(idx)=0;
idx=isnan(a1_td); a1_td(idx)=0; n1_td(idx)=0;
idx=isnan(a1_mc); a1_mc(idx)=0; n1_mc(idx)=0;
idx=isnan(a2_ar); a2_ar(idx)=0; n2_ar(idx)=0;
idx=isnan(a2_tc); a2_tc(idx)=0; n2_tc(idx)=0;
idx=isnan(a2_td); a2_td(idx)=0; n2_td(idx)=0;
idx=isnan(a2_mc); a2_mc(idx)=0; n2_mc(idx)=0;
a1=(a1_ar.*n1_ar+a1_tc.*n1_tc+a1_td.*n1_td+a1_mc.*n1_mc)./(n1_ar+n1_tc+n1_td+n1_mc);
a2=(a2_ar.*n2_ar+a2_tc.*n2_tc+a2_td.*n2_td+a2_mc.*n2_mc)./(n2_ar+n2_tc+n2_td+n2_mc);
p.z6=(a2-a1)/dTs; p.z0=p.z6;
%clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean T_{850}';
p.s2='(c) \DeltaT_{850} averaged over AR conditions'; 
p.s3='(d) \DeltaT_{850} averaged over TS conditions'; 
p.s4='(e) \DeltaT_{850} averaged over TD conditions'; 
p.s5='(f) \DeltaT_{850} averaged over MCS conditions';
p.s6='(b) \DeltaT_{850} over AR+TS+TD+MCS conditions'; p.s0='';
p.c1=[0 7]; a=[0 7]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) \DeltaT_{850} averaged over AR conditions'; 
p.s3='(b) \DeltaT_{850} averaged over TS conditions'; 
p.s4='(c) \DeltaT_{850} averaged over TD conditions'; 
p.s5='(d) \DeltaT_{850} averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 22: change in TAS averaged only over AR/TS/TD/MSC conditions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_tas_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=4; p.nn=128; p.c='k'; dTs=4.52; no=20; dTs=1;
v=v1.ar; a1=squeeze(v.tas_av); %s1=squeeze(v.tas_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.tas_av); %s2=squeeze(v.tas_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)/dTs; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.tas_idavg); s1=squeeze(v.tas_idstd); n1=squeeze(v.id_sum); a1_ar=a1;n1_ar=n1;
v=w1.ar; a2=squeeze(v.tas_idavg); s2=squeeze(v.tas_idstd); n2=squeeze(v.id_sum); a2_ar=a2;n2_ar=n2;
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.tas_idavg); s1=squeeze(v.tas_idstd); n1=squeeze(v.id_sum); a1_tc=a1;n1_tc=n1;
v=w1.tc; a2=squeeze(v.tas_idavg); s2=squeeze(v.tas_idstd); n2=squeeze(v.id_sum); a2_tc=a2;n2_tc=n2;
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;;
v=v1.td; a1=squeeze(v.tas_idavg); s1=squeeze(v.tas_idstd); n1=squeeze(v.id_sum); a1_td=a1;n1_td=n1;
v=w1.td; a2=squeeze(v.tas_idavg); s2=squeeze(v.tas_idstd); n2=squeeze(v.id_sum); a2_td=a2;n2_td=n2;
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;;
v=v1.mc; a1=squeeze(v.tas_idavg); s1=squeeze(v.tas_idstd); n1=squeeze(v.id_sum); a1_mc=a1;n1_mc=n1;
v=w1.mc; a2=squeeze(v.tas_idavg); s2=squeeze(v.tas_idstd); n2=squeeze(v.id_sum); a2_mc=a2;n2_mc=n2;
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;;
idx=isnan(a1_ar); a1_ar(idx)=0; n1_ar(idx)=0;
idx=isnan(a1_tc); a1_tc(idx)=0; n1_tc(idx)=0;
idx=isnan(a1_td); a1_td(idx)=0; n1_td(idx)=0;
idx=isnan(a1_mc); a1_mc(idx)=0; n1_mc(idx)=0;
idx=isnan(a2_ar); a2_ar(idx)=0; n2_ar(idx)=0;
idx=isnan(a2_tc); a2_tc(idx)=0; n2_tc(idx)=0;
idx=isnan(a2_td); a2_td(idx)=0; n2_td(idx)=0;
idx=isnan(a2_mc); a2_mc(idx)=0; n2_mc(idx)=0;
a1=(a1_ar.*n1_ar+a1_tc.*n1_tc+a1_td.*n1_td+a1_mc.*n1_mc)./(n1_ar+n1_tc+n1_td+n1_mc);
a2=(a2_ar.*n2_ar+a2_tc.*n2_tc+a2_td.*n2_td+a2_mc.*n2_mc)./(n2_ar+n2_tc+n2_td+n2_mc);
p.z6=(a2-a1)/dTs; p.z0=p.z6;
%clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean TAS';
p.s2='(a) \DeltaTAS averaged over AR conditions'; 
p.s3='(b) \DeltaTAS averaged over TS conditions'; 
p.s4='(c) \DeltaTAS averaged over TD conditions'; 
p.s5='(d) \DeltaTAS averaged over MCS conditions';
p.s6='(b) \DeltaTAS over AR+TS+TD+MCS conditions'; p.s0='';
p.c1=[0 7]; a=[0 7]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) \DeltaTAS averaged over AR conditions'; 
p.s3='(b) \DeltaTAS averaged over TS conditions'; 
p.s4='(c) \DeltaTAS averaged over TD conditions'; 
p.s5='(d) \DeltaTAS averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 23: change in T500 averaged only over AR/TS/TD/MSC conditions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_t500_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=4; p.nn=128; p.c='k'; dTs=4.52; no=20; dTs=1;
v=v1.ar; a1=squeeze(v.t500_av); %s1=squeeze(v.t500_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.t500_av); %s2=squeeze(v.t500_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)/dTs; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.t500_idavg); s1=squeeze(v.t500_idstd); n1=squeeze(v.id_sum);
v=w1.ar; a2=squeeze(v.t500_idavg); s2=squeeze(v.t500_idstd); n2=squeeze(v.id_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.t500_idavg); s1=squeeze(v.t500_idstd); n1=squeeze(v.id_sum); 
v=w1.tc; a2=squeeze(v.t500_idavg); s2=squeeze(v.t500_idstd); n2=squeeze(v.id_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;;
v=v1.td; a1=squeeze(v.t500_idavg); s1=squeeze(v.t500_idstd); n1=squeeze(v.id_sum); 
v=w1.td; a2=squeeze(v.t500_idavg); s2=squeeze(v.t500_idstd); n2=squeeze(v.id_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;;
v=v1.mc; a1=squeeze(v.t500_idavg); s1=squeeze(v.t500_idstd); n1=squeeze(v.id_sum); 
v=w1.mc; a2=squeeze(v.t500_idavg); s2=squeeze(v.t500_idstd); n2=squeeze(v.id_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean T_{500}';
p.s2='(c) \Delta AR mean T_{500}'; 
p.s3='(d) \Delta TS mean T_{500}'; 
p.s4='(e) \Delta TD mean T_{500}'; 
p.s5='(f) \Delta MCS mean T_{500}';
p.s6='(b) \Delta AR+TS+TD+MCS T_{500}'; p.s0='';
p.c1=[0 7]; a=[0 7]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) \DeltaT_{500} averaged over AR conditions'; 
p.s3='(b) \DeltaT_{500} averaged over TS conditions'; 
p.s4='(c) \DeltaT_{500} averaged over TD conditions'; 
p.s5='(d) \DeltaT_{500} averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 24: change in LW CRE averaged only over AR/TS/TD/MSC conditions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_lwcf_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=4; p.nn=128; p.c='k'; dTs=4.52; no=20;
v=v1.ar; a1=squeeze(v.lwcf_av); %s1=squeeze(v.lwcf_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.lwcf_av); %s2=squeeze(v.lwcf_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)/dTs; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); a1_ar=a1;n1_ar=n1;
v=w1.ar; a2=squeeze(v.lwcf_idavg); s2=squeeze(v.lwcf_idstd); n2=squeeze(v.id_sum); a2_ar=a2;n2_ar=n2;
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); a1_tc=a1;n1_tc=n1;
v=w1.tc; a2=squeeze(v.lwcf_idavg); s2=squeeze(v.lwcf_idstd); n2=squeeze(v.id_sum); a2_tc=a2;n2_tc=n2;
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;;
v=v1.td; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); a1_td=a1;n1_td=n1;
v=w1.td; a2=squeeze(v.lwcf_idavg); s2=squeeze(v.lwcf_idstd); n2=squeeze(v.id_sum); a2_td=a2;n2_td=n2;
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;;
v=v1.mc; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); a1_mc=a1;n1_mc=n1;
v=w1.mc; a2=squeeze(v.lwcf_idavg); s2=squeeze(v.lwcf_idstd); n2=squeeze(v.id_sum); a2_mc=a2;n2_mc=n2;
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;;
idx=isnan(a1_ar); a1_ar(idx)=0; n1_ar(idx)=0;
idx=isnan(a1_tc); a1_tc(idx)=0; n1_tc(idx)=0;
idx=isnan(a1_td); a1_td(idx)=0; n1_td(idx)=0;
idx=isnan(a1_mc); a1_mc(idx)=0; n1_mc(idx)=0;
idx=isnan(a2_ar); a2_ar(idx)=0; n2_ar(idx)=0;
idx=isnan(a2_tc); a2_tc(idx)=0; n2_tc(idx)=0;
idx=isnan(a2_td); a2_td(idx)=0; n2_td(idx)=0;
idx=isnan(a2_mc); a2_mc(idx)=0; n2_mc(idx)=0;
a1=(a1_ar.*n1_ar+a1_tc.*n1_tc+a1_td.*n1_td+a1_mc.*n1_mc)./(n1_ar+n1_tc+n1_td+n1_mc);
a2=(a2_ar.*n2_ar+a2_tc.*n2_tc+a2_td.*n2_td+a2_mc.*n2_mc)./(n2_ar+n2_tc+n2_td+n2_mc);
p.z6=(a2-a1)/dTs; p.z0=p.z6;
%clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5; p.z6=nanmean(a,3);
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean LW CRE';
p.s2='(c) \DeltaLW CRE averaged over AR conditions'; 
p.s3='(d) \DeltaLW CRE averaged over TS conditions'; 
p.s4='(e) \DeltaLW CRE averaged over TD conditions'; 
p.s5='(f) \DeltaLW CRE averaged over MCS conditions';
p.s6='(b) \Delta LW CRE over AR+TS+TD+MCS condition'; p.s0='';
p.c1=[-2 2]; a=[-2 2]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) \DeltaLW CRE averaged over AR conditions'; 
p.s3='(b) \DeltaLW CRE averaged over TS conditions'; 
p.s4='(c) \DeltaLW CRE averaged over TD conditions'; 
p.s5='(d) \DeltaLW CRE averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig 25: change in SW CRE averaged only over AR/TS/TD/MSC conditions
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_swcf_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=4; p.nn=128; p.c='k'; dTs=4.52; no=20;
v=v1.ar; a1=squeeze(v.swcf_av); %s1=squeeze(v.swcf_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.swcf_av); %s2=squeeze(v.swcf_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)/dTs; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
v=w1.ar; a2=squeeze(v.swcf_idavg); s2=squeeze(v.swcf_idstd); n2=squeeze(v.id_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
v=w1.tc; a2=squeeze(v.swcf_idavg); s2=squeeze(v.swcf_idstd); n2=squeeze(v.id_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;;
v=v1.td; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
v=w1.td; a2=squeeze(v.swcf_idavg); s2=squeeze(v.swcf_idstd); n2=squeeze(v.id_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;;
v=v1.mc; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
v=w1.mc; a2=squeeze(v.swcf_idavg); s2=squeeze(v.swcf_idstd); n2=squeeze(v.id_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='(a) \Delta annual mean SW CRE';
p.s2='(c) \DeltaSW CRE averaged over AR conditions'; 
p.s3='(d) \DeltaSW CRE averaged over TS conditions'; 
p.s4='(e) \DeltaSW CRE averaged over TD conditions'; 
p.s5='(f) \DeltaSW CRE averaged over MCS conditions';
p.s6='(b) \Delta SW CRE over AR+TS+TD+MCS condition'; p.s0='';
p.c1=[-5 5]; a=[-5 5]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
p.s2='(a) \DeltaSW CRE averaged over AR conditions'; 
p.s3='(b) \DeltaSW CRE averaged over TS conditions'; 
p.s4='(c) \DeltaSW CRE averaged over TD conditions'; 
p.s5='(d) \DeltaSW CRE averaged over MCS conditions';
plot_2d_4panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%Fig. prday_idavg_p99%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; I=1; no=20;
v=v1.ar; a1=squeeze(v.prday_pct(1,I,:,:)); %s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prday_pct(1,I,:,:)); %s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.ar; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.tc; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.td; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.mc; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6; %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change of Pr 99 percentile (P99)';
p.s2='percent change of Pr for AR (Pr>=P99)'; 
p.s3='percent change of Pr for TS (Pr>=P99)'; 
p.s4='percent change of Pr for TD (Pr>=P99)'; 
p.s5='percent change of Pr for MSC (Pr>=P99)';
p.s6='percent change of Pr for ALL (Pr>=P99)'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
p.s2='\Delta Pr averaged over AR conditions with Pr>P99'; 
p.s3='\Delta Pr averaged over TS conditions with Pr>P99'; 
p.s4='\Delta Pr averaged over TD conditions with Pr>P99'; 
p.s5='\Delta Pr averaged over MSC conditions with Pr>P99';
plot_2d_4panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%omega500%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_w500_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; I=1; no=20;
v=v1.ar; a1=squeeze(v.prday_pct(1,I,:,:)); %s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prday_pct(1,I,:,:)); %s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.w500_idavg_p99); s1=squeeze(v.w500_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.ar; a2=squeeze(v.w500_idavg_p99); s2=squeeze(v.w500_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.w500_idavg_p99); s1=squeeze(v.w500_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.tc; a2=squeeze(v.w500_idavg_p99); s2=squeeze(v.w500_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.w500_idavg_p99); s1=squeeze(v.w500_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.td; a2=squeeze(v.w500_idavg_p99); s2=squeeze(v.w500_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.w500_idavg_p99); s1=squeeze(v.w500_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.mc; a2=squeeze(v.w500_idavg_p99); s2=squeeze(v.w500_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6; %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change in Pr 99 percentile (P99)';
p.s2='percent change in \omega_{500} for AR (Pr>=P99)'; 
p.s3='percent change in \omega_{500} for TS (Pr>=P99)'; 
p.s4='percent change in \omega_{500} for TD (Pr>=P99)'; 
p.s5='percent change in \omega_{500} for MSC (Pr>=P99)';
p.s6='percent change in \omega_{500} for ALL (Pr>=P99)'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
plot_2d_4panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PRW%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prw_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; I=1; no=20;
v=v1.ar; a1=squeeze(v.prday_pct(1,I,:,:)); %s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prday_pct(1,I,:,:)); %s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.prw_idavg_p99); s1=squeeze(v.prw_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.ar; a2=squeeze(v.prw_idavg_p99); s2=squeeze(v.prw_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prw_idavg_p99); s1=squeeze(v.prw_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.tc; a2=squeeze(v.prw_idavg_p99); s2=squeeze(v.prw_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prw_idavg_p99); s1=squeeze(v.prw_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.td; a2=squeeze(v.prw_idavg_p99); s2=squeeze(v.prw_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prw_idavg_p99); s1=squeeze(v.prw_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.mc; a2=squeeze(v.prw_idavg_p99); s2=squeeze(v.prw_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6; %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change in Pr 99 percentile (P99)';
p.s2='percent change in PRW for AR (Pr>=P99)'; 
p.s3='percent change in PRW for TS (Pr>=P99)'; 
p.s4='percent change in PRW for TD (Pr>=P99)'; 
p.s5='percent change in PRW for MSC (Pr>=P99)';
p.s6='percent change in PRW for ALL (Pr>=P99)'; p.s0='';
p.c1=[-10 10]; a=[0 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
plot_2d_4panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%HUS850%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_q850_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; I=1; no=20;
v=v1.ar; a1=squeeze(v.prday_pct(1,I,:,:)); %s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prday_pct(1,I,:,:)); %s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.q850_idavg_p99); s1=squeeze(v.q850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.ar; a2=squeeze(v.q850_idavg_p99); s2=squeeze(v.q850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.q850_idavg_p99); s1=squeeze(v.q850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.tc; a2=squeeze(v.q850_idavg_p99); s2=squeeze(v.q850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.q850_idavg_p99); s1=squeeze(v.q850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.td; a2=squeeze(v.q850_idavg_p99); s2=squeeze(v.q850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.q850_idavg_p99); s1=squeeze(v.q850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.mc; a2=squeeze(v.q850_idavg_p99); s2=squeeze(v.q850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6; %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change in Pr 99 percentile (P99)';
p.s2='percent change in HUS_{850} for AR (Pr>=P99)'; 
p.s3='percent change in HUS_{850} for TS (Pr>=P99)'; 
p.s4='percent change in HUS_{850} for TD (Pr>=P99)'; 
p.s5='percent change in HUS_{850} for MSC (Pr>=P99)';
p.s6='percent change in HUS_{850} for ALL (Pr>=P99)'; p.s0='';
p.c1=[-10 10]; a=[0 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
plot_2d_4panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%HUS850%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_q850_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; I=1; no=20;
v=v1.ar; a1=squeeze(v.prday_pct(1,I,:,:)); %s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prday_pct(1,I,:,:)); %s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.q850_idavg_p99); s1=squeeze(v.q850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.ar; a2=squeeze(v.q850_idavg_p99); s2=squeeze(v.q850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.q850_idavg_p99); s1=squeeze(v.q850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.tc; a2=squeeze(v.q850_idavg_p99); s2=squeeze(v.q850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.q850_idavg_p99); s1=squeeze(v.q850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.td; a2=squeeze(v.q850_idavg_p99); s2=squeeze(v.q850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.q850_idavg_p99); s1=squeeze(v.q850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.mc; a2=squeeze(v.q850_idavg_p99); s2=squeeze(v.q850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6; %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change in Pr 99 percentile (P99)';
p.s2='percent change in HUS_{850} for AR (Pr>=P99)'; 
p.s3='percent change in HUS_{850} for TS (Pr>=P99)'; 
p.s4='percent change in HUS_{850} for TD (Pr>=P99)'; 
p.s5='percent change in HUS_{850} for MSC (Pr>=P99)';
p.s6='percent change in HUS_{850} for ALL (Pr>=P99)'; p.s0='';
p.c1=[-10 10]; a=[0 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
plot_2d_4panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%T850%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_T850_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; I=1; no=20;
v=v1.ar; a1=squeeze(v.prday_pct(1,I,:,:)); %s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prday_pct(1,I,:,:)); %s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.t850_idavg_p99); s1=squeeze(v.t850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.ar; a2=squeeze(v.t850_idavg_p99); s2=squeeze(v.t850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.t850_idavg_p99); s1=squeeze(v.t850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.tc; a2=squeeze(v.t850_idavg_p99); s2=squeeze(v.t850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;;
v=v1.td; a1=squeeze(v.t850_idavg_p99); s1=squeeze(v.t850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.td; a2=squeeze(v.t850_idavg_p99); s2=squeeze(v.t850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;;
v=v1.mc; a1=squeeze(v.t850_idavg_p99); s1=squeeze(v.t850_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.mc; a2=squeeze(v.t850_idavg_p99); s2=squeeze(v.t850_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6; %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change in Pr 99 percentile (P99)';
p.s2='change in T850 for AR (Pr>=P99)'; 
p.s3='change in T850 for TS (Pr>=P99)'; 
p.s4='change in T850 for TD (Pr>=P99)'; 
p.s5='change in T850 for MSC (Pr>=P99)';
p.s6='change in T850 for ALL (Pr>=P99)'; p.s0='';
p.c1=[-10 10]; a=[0 1.5]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
plot_2d_4panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%TAS%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_TAS_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; I=1; no=20;
v=v1.ar; a1=squeeze(v.prday_pct(1,I,:,:)); %s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prday_pct(1,I,:,:)); %s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.tas_idavg_p99); s1=squeeze(v.tas_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.ar; a2=squeeze(v.tas_idavg_p99); s2=squeeze(v.tas_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.tas_idavg_p99); s1=squeeze(v.tas_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.tc; a2=squeeze(v.tas_idavg_p99); s2=squeeze(v.tas_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;;
v=v1.td; a1=squeeze(v.tas_idavg_p99); s1=squeeze(v.tas_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.td; a2=squeeze(v.tas_idavg_p99); s2=squeeze(v.tas_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;;
v=v1.mc; a1=squeeze(v.tas_idavg_p99); s1=squeeze(v.tas_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.mc; a2=squeeze(v.tas_idavg_p99); s2=squeeze(v.tas_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6; %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change in Pr 99 percentile (P99)';
p.s2='change in TAS for AR (Pr>=P99)'; 
p.s3='change in TAS for TS (Pr>=P99)'; 
p.s4='change in TAS for TD (Pr>=P99)'; 
p.s5='change in TAS for MSC (Pr>=P99)';
p.s6='change in TAS for ALL (Pr>=P99)'; p.s0='';
p.c1=[-10 10]; a=[-0.5 1.5]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
plot_2d_4panel(p);







%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: present-day climo
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %occurrence frequency: fraction of all days
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='frqday'; 
p.xy=[0 360 -90 90]; p.xy=[200 320 0 70];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.prday_fqwet(1,:,:,2));
p.z2=squeeze(v1.ar.frqday);   
p.z3=squeeze(v1.tc.frqday);
p.z4=squeeze(v1.td.frqday);
p.z5=squeeze(v1.mc.frqday);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='frequency of wet day';
p.s2='frequency of AR days'; 
p.s3='frequency of TS days'; 
p.s4='frequency of TD days'; 
p.s5='frequency of MCS days';
p.s6='SUM=AR+TS+TD+MCS'; p.s0='';
p.c1=[0 1]; a=[0 0.4]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=[0 1];
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl';%occurrence frequency: fraction of the wet days
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='frqday_frac';
p.xy=[0 360 -90 90]; p.xy=[190 320 0 72];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.prday_fqwet(1,:,:,2));
p.z2=squeeze(v1.ar.frqday)./p.z1;   
p.z3=squeeze(v1.tc.frqday)./p.z1;
p.z4=squeeze(v1.td.frqday)./p.z1;
p.z5=squeeze(v1.mc.frqday)./p.z1; 
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='frequency of wet day';
p.s2='fraction of AR days'; 
p.s3='fraction of TS days'; 
p.s4='fraction of TD days'; 
p.s5='fraction of MCS days';
p.s6='SUM=AR+TS+TD+MCS'; p.s0='';
p.c1=[0 1]; a=[0 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %fraction of P>P99 from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='prday_fp99_from_id';
p.xy=[0 360 -90 90]; p.xy=[190 320 0 72];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.prday_pct(:,1,:,:));
p.z2=squeeze(v1.ar.prday_fp99_from_id);   
p.z3=squeeze(v1.tc.prday_fp99_from_id);
p.z4=squeeze(v1.td.prday_fp99_from_id);
p.z5=squeeze(v1.mc.prday_fp99_from_id);
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='99 percentile of daily precip';
p.s2='fraction from AR'; 
p.s3='fraction from TS'; 
p.s4='fraction from TD'; 
p.s5='fraction from MCS';
p.s6='SUM=AR+TS+TD+MCS'; p.s0='';
p.c1=[0 100]; a=[0 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %fraction of P>P99.9 from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='prday_fp999_from_id';
p.xy=[0 360 -90 90]; p.xy=[190 320 0 72];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.prday_pct(:,2,:,:));
p.z2=squeeze(v1.ar.prday_fp999_from_id);   
p.z3=squeeze(v1.tc.prday_fp999_from_id);
p.z4=squeeze(v1.td.prday_fp999_from_id);
p.z5=squeeze(v1.mc.prday_fp999_from_id);
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='99.9 percentile of daily precip';
p.s2='fraction from AR'; 
p.s3='fraction from TS'; 
p.s4='fraction from TD'; 
p.s5='fraction from MCS';
p.s6='SUM=AR+TS+TD+MCS'; p.s0='';
p.c1=[0 200]; a=[0 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %all time mean prday from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='prday_idwei';
p.xy=[0 360 -90 90]; p.xy=[190 320 0 72];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.prday_av);   
p.z2=squeeze(v1.ar.prday_idwei);   
p.z3=squeeze(v1.tc.prday_idwei); 
p.z4=squeeze(v1.td.prday_idwei);
p.z5=squeeze(v1.mc.prday_idwei);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='annual mean precipitation, P';
p.s2='annual mean AR precipitation'; 
p.s3='annual mean TS precipitation'; 
p.s4='annual mean TD precipitation'; 
p.s5='annual mean MCS precipitation';
p.s6='SUM=AR+TS+TD+MCS precipitation'; p.s0='';
p.c1=[0 10]; p.c2=[0 3]; p.c3=[0 3]; p.c4=[0 3]; p.c5=[0 6]; p.c6=[0 10]; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %fraction of prday from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='prday_idwei_frac';
p.xy=[0 360 -90 90]; p.xy=[190 320 0 72];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.prday_av); %p.z1=squeeze(v1.ar.prday_awwet(1,:,:,2)); 
p.z2=squeeze(v1.ar.prday_idwei);   
p.z3=squeeze(v1.tc.prday_idwei);
p.z4=squeeze(v1.td.prday_idwei);
p.z5=squeeze(v1.mc.prday_idwei);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6; 
a=p.z1; p.z2=p.z2./a; p.z3=p.z3./a; p.z4=p.z4./a; p.z5=p.z5./a; p.z6=p.z6./a;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='annual mean precipitation P';
p.s2='fraction of P from AR'; 
p.s3='fraction of P from TS'; 
p.s4='fraction of P from TD'; 
p.s5='fraction of P from MCS';
p.s6='fraction of P from AR+TS+TD+MCS'; p.s0='';
p.c1=[0 12]; p.c2=[0 1]; p.c3=[0 1]; p.c4=[0 1]; p.c5=[0 1]; p.c6=[0 1]; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %weather type mean prday
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='prday_idavg';
p.xy=[0 360 -90 90]; p.xy=[190 320 0 72];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='k';
p.z1=squeeze(v1.ar.prday_av); p.z0=p.z1; no=1;
v=v1.ar; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
[p.z2]=compute_se(a1,s1,n1,no);
v=v1.tc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
[p.z3]=compute_se(a1,s1,n1,no);
v=v1.td; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
[p.z4]=compute_se(a1,s1,n1,no);
v=v1.mc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
[p.z5]=compute_se(a1,s1,n1,no);
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='annual mean precipitation';
p.s2='AR'; p.s3='TS'; p.s4='TD'; p.s5='MCS';
p.s6='AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[0 15]; a=[0 15]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %weather type 99 percentile for prday
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='prday_idavg_p99';
p.xy=[0 360 -90 90]; p.xy=[190 320 0 72];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='k';
p.z1=squeeze(v1.ar.prday_pct(1,1,:,:)); p.z0=p.z1; no=1;
v=v1.ar; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
[p.z2]=compute_se(a1,s1,n1,no);
v=v1.tc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
[p.z3]=compute_se(a1,s1,n1,no);
v=v1.td; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
[p.z4]=compute_se(a1,s1,n1,no);
v=v1.mc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
[p.z5]=compute_se(a1,s1,n1,no);
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='99 percentile of daily precip, P99';
p.s2='AVG AR P>=P99'; 
p.s3='AVG TS P>=P99'; 
p.s4='AVG TD P>=P99'; 
p.s5='AVG MSC P>=P99';
p.s6='AVG AR+TS+TD+MCS P>=P99'; p.s0='';
p.c1=[0 100]; a=[0 100]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %weather type 99.9 percentile for prday
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='prday_idavg_p999';
p.xy=[0 360 -90 90]; p.xy=[190 320 0 72];
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='k';
p.z1=squeeze(v1.ar.prday_pct(1,2,:,:)); p.z0=p.z1; no=5;
v=v1.ar; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
[p.z2]=compute_se(a1,s1,n1,no);
v=v1.tc; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
[p.z3]=compute_se(a1,s1,n1,no);
v=v1.td; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
[p.z4]=compute_se(a1,s1,n1,no);
v=v1.mc; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
[p.z5]=compute_se(a1,s1,n1,no);
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='99.9 percentile of daily precip, P99.9';
p.s2='AVG AR P>=P99.9'; 
p.s3='AVG TS P>=P99.9'; 
p.s4='AVG TD P>=P99.9'; 
p.s5='AVG MSC P>=P99.9';
p.s6='AVG AR+TS+TD+MCS P>=P99.9'; p.s0='';
p.c1=[0 200]; a=[0 200]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%LWCF%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %all time mean lwcf from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='lwcf_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.lwcf_av);
p.z2=squeeze(v1.ar.lwcf_idwei);   
p.z3=squeeze(v1.tc.lwcf_idwei);
p.z4=squeeze(v1.td.lwcf_idwei);
p.z5=squeeze(v1.mc.lwcf_idwei);
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='LW CRF';
p.s2='LW CRE from AR'; 
p.s3='LW CRE from TS'; 
p.s4='LW CRE from TD'; 
p.s5='LW CRE from MCS';
p.s6='SUM=AR+TS+TD+MCS'; p.s0='';
p.c1=[0 80]; a=[0 40]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %fraction of lwcf from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='lwcf_idwei_frac';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1];p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.lwcf_av); %p.z1=squeeze(v1.ar.prday_awwet(1,:,:,2)); 
p.z2=squeeze(v1.ar.lwcf_idwei);   
p.z3=squeeze(v1.tc.lwcf_idwei);
p.z4=squeeze(v1.td.lwcf_idwei);
p.z5=squeeze(v1.mc.lwcf_idwei);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6; 
a=p.z1; p.z2=p.z2./a; p.z3=p.z3./a; p.z4=p.z4./a; p.z5=p.z5./a; p.z6=p.z6./a;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='annual mean LW CRE (W/m2)';
p.s2='fraction of from AR'; 
p.s3='fraction of from TS'; 
p.s4='fraction of from TD'; 
p.s5='fraction of from MCS';
p.s6='fraction of from AR+TS+TD+MCS'; p.s0='';
p.c1=[0 80]; p.c2=[0 1]; p.c3=[0 1]; p.c4=[0 1]; p.c5=[0 1]; p.c6=[0 1]; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %weather type mean lwcf
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='lwcf_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='k';
p.z1=squeeze(v1.ar.lwcf_av); p.z0=p.z1; no=10;
v=v1.ar; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); 
[p.z2]=compute_se(a1,s1,n1,no);
v=v1.tc; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); 
[p.z3]=compute_se(a1,s1,n1,no);
v=v1.td; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); 
[p.z4]=compute_se(a1,s1,n1,no);
v=v1.mc; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum); 
[p.z5]=compute_se(a1,s1,n1,no);
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='annual mean LW CRE (W/m2)';
p.s2='AR mean'; p.s3='TS mean'; p.s4='TD mean'; p.s5='MCS mean';
p.s6='AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[0 80]; a=[0 80]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%SWCF%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %all time mean swcf from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='swcf_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.swcf_av);
p.z2=squeeze(v1.ar.swcf_idwei);   
p.z3=squeeze(v1.tc.swcf_idwei);
p.z4=squeeze(v1.td.swcf_idwei);
p.z5=squeeze(v1.mc.swcf_idwei);
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='SW CRE';
p.s2='SW CRE from AR'; 
p.s3='SW CRE from TS'; 
p.s4='SW CRE from TD'; 
p.s5='SW CRE from MCS';
p.s6='SUM=AR+TS+TD+MCS'; p.s0='';
p.c1=[-80 0]; a=[-40 0]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %fraction of swcf from each weather type
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='swcf_idwei_frac';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1];p.opt=1;p.nn=64; p.c='w';
p.z1=squeeze(v1.ar.swcf_av); %p.z1=squeeze(v1.ar.prday_awwet(1,:,:,2)); 
p.z2=squeeze(v1.ar.swcf_idwei);   
p.z3=squeeze(v1.tc.swcf_idwei);
p.z4=squeeze(v1.td.swcf_idwei);
p.z5=squeeze(v1.mc.swcf_idwei);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6; 
a=p.z1; p.z2=p.z2./a; p.z3=p.z3./a; p.z4=p.z4./a; p.z5=p.z5./a; p.z6=p.z6./a;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='annual mean SW CRE (W/m2)';
p.s2='fraction of P from AR'; 
p.s3='fraction of P from TS'; 
p.s4='fraction of P from TD'; 
p.s5='fraction of P from MCS';
p.s6='fraction of P from AR+TS+TD+MCS'; p.s0='';
p.c1=[-80 0]; p.c2=[0 1]; p.c3=[0 1]; p.c4=[0 1]; p.c5=[0 1]; p.c6=[0 1]; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='ctl'; %weather type mean swcf
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='swcf_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[0 0.0005 0.001 0.002 0.01:0.02:0.08 0.1:0.05:1]; p.opt=1;p.nn=64; p.c='k';
p.z1=squeeze(v1.ar.swcf_av); p.z0=p.z1; no=1;
v=v1.ar; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
[p.z2]=compute_se(a1,s1,n1,no);
v=v1.tc; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
[p.z3]=compute_se(a1,s1,n1,no);
v=v1.td; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
[p.z4]=compute_se(a1,s1,n1,no);
v=v1.mc; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum); 
[p.z5]=compute_se(a1,s1,n1,no);
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='annual mean SW CRE (W/m2)';
p.s2='AR mean'; p.s3='TS mean'; p.s4='TD mean'; p.s5='MCS mean';
p.s6='AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[-80 0]; a=[-150 0]; p.c2=a; p.c3=a; p.c4=a; p.c5=[-150 0]; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_frqday';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-0.1: 0.005: 0.1]; p.opt=2; p.nn=64; p.c='k';
p.z1=squeeze(w1.ar.prday_fqwet(1,:,:,2) - v1.ar.prday_fqwet(1,:,:,2));
p.z2=squeeze(w1.ar.frqday - v1.ar.frqday);
p.z3=squeeze(w1.tc.frqday - v1.tc.frqday);
p.z4=squeeze(w1.td.frqday - v1.td.frqday);
p.z5=squeeze(w1.mc.frqday - v1.mc.frqday);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='\Delta frequency of wet day';
p.s2='\Delta frequency of AR days'; 
p.s3='\Delta frequency of TS days'; 
p.s4='\Delta frequency of TD days'; 
p.s5='\Delta frequency of MCS days';
p.s6='\Delta SUM=AR+TS+TD+MCS days'; p.s0='';
p.c1=[-0.1 0.1]; a=[-0.04 0.04]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_fp99_from_id';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k';
a=squeeze(w1.ar.prday_pct(:,1,:,:)); b=squeeze(v1.ar.prday_pct(:,1,:,:));p.z1=a-b;
a=squeeze(w1.ar.prday_fp99_from_id); b=squeeze(v1.ar.prday_fp99_from_id);p.z2=a-b;
a=squeeze(w1.tc.prday_fp99_from_id); b=squeeze(v1.tc.prday_fp99_from_id);p.z3=a-b;
a=squeeze(w1.td.prday_fp99_from_id); b=squeeze(v1.td.prday_fp99_from_id);p.z4=a-b;
a=squeeze(w1.mc.prday_fp99_from_id); b=squeeze(v1.mc.prday_fp99_from_id);p.z5=a-b;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3);  p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='\Delta 99 percentile of daily precip';
p.s2='\Delta fraction from AR'; 
p.s3='\Delta fraction from TS'; 
p.s4='\Delta fraction from TD'; 
p.s5='\Delta fraction from MCS';
p.s6='\Delta AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[-10 10]; a=[-0.1 0.1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_fp999_from_id';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k';
a=squeeze(w1.ar.prday_pct(:,2,:,:));  b=squeeze(v1.ar.prday_pct(:,2,:,:));p.z1=a-b;
a=squeeze(w1.ar.prday_fp999_from_id); b=squeeze(v1.ar.prday_fp999_from_id);p.z2=a-b;
a=squeeze(w1.tc.prday_fp999_from_id); b=squeeze(v1.tc.prday_fp999_from_id);p.z3=a-b;
a=squeeze(w1.td.prday_fp999_from_id); b=squeeze(v1.td.prday_fp999_from_id);p.z4=a-b;
a=squeeze(w1.mc.prday_fp999_from_id); b=squeeze(v1.mc.prday_fp999_from_id);p.z5=a-b;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3);  p.z0=p.z6;
p=smoothp(p,5,5,'omitnan','shrink');
p.s1='\Delta 99.9 percentile of daily precip';
p.s2='\Delta fraction from AR'; 
p.s3='\Delta fraction from TS'; 
p.s4='\Delta fraction from TD'; 
p.s5='\Delta fraction from MCS';
p.s6='\Delta AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[-20 20]; a=[-0.1 0.1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
p.z1=squeeze(w1.ar.prday_av   -v1.ar.prday_av)/dTs;
p.z2=squeeze(w1.ar.prday_idwei-v1.ar.prday_idwei)/dTs;   
p.z3=squeeze(w1.tc.prday_idwei-v1.tc.prday_idwei)/dTs;
p.z4=squeeze(w1.td.prday_idwei-v1.td.prday_idwei)/dTs;
p.z5=squeeze(w1.mc.prday_idwei-v1.mc.prday_idwei)/dTs;    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean precipitation';
p.s2='\Delta AR precipitation'; 
p.s3='\Delta TS precipitation'; 
p.s4='\Delta TD precipitation'; 
p.s5='\Delta MCS precipitation';
p.s6='\Delta SUM=AR+TS+TD+MCS precipitation'; p.s0='';
p.c1=[-0.4 0.4]; a=[-0.2 0.2]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=[-0.4 0.4]; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_idwei_frac';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a0=squeeze(w1.ar.prday_av);    b0=squeeze(v1.ar.prday_av);    p.z1=(a0-b0)./b0/dTs*100;
a =squeeze(w1.ar.prday_idwei); b =squeeze(v1.ar.prday_idwei); p.z2=(a./a0-b./b0)*100;
a =squeeze(w1.tc.prday_idwei); b =squeeze(v1.tc.prday_idwei); p.z3=(a./a0-b./b0)*100;
a =squeeze(w1.td.prday_idwei); b =squeeze(v1.td.prday_idwei); p.z4=(a./a0-b./b0)*100;
a =squeeze(w1.mc.prday_idwei); b =squeeze(v1.mc.prday_idwei); p.z5=(a./a0-b./b0)*100;
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='percent change of annual mean P';
p.s2='\Delta fraction of P from AR'; 
p.s3='\Delta fraction of P from TS'; 
p.s4='\Delta fraction of P from TD'; 
p.s5='\Delta fraction of P from MCS';
p.s6='\Delta fraction of P from AR+TS+TD+MCS'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=20;
a=squeeze(w1.ar.prday_av); b=squeeze(v1.ar.prday_av); p.z1=(a-b)./b/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w1.ar; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w1.tc; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w1.td; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w1.mc; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean precipitation';
p.s2='\Delta AR mean precipitation'; 
p.s3='\Delta TS mean precipitation'; 
p.s4='\Delta TD mean precipitation'; 
p.s5='\Delta MCS mean precipitation';
p.s6='\Delta AVG (AR+TS+TD+MCS) precipitation'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; I=1; no=20;
v=v1.ar; a1=squeeze(v.prday_pct(1,I,:,:)); %s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prday_pct(1,I,:,:)); %s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum);
p.z1=(a2-a1)./a1/dTs*100; %[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;
v=v1.ar; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.ar; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.tc; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.td; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.mc; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6; %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change of Pr 99 percentile (P99)';
p.s2='percent change of Pr for AR (Pr>=P99)'; 
p.s3='percent change of Pr for TS (Pr>=P99)'; 
p.s4='percent change of Pr for TD (Pr>=P99)'; 
p.s5='percent change of Pr for MSC (Pr>=P99)';
p.s6='percent change of Pr for ALL (Pr>=P99)'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg_p999';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; no=1;
a=squeeze(w1.ar.prday_pct(1,2,:,:)); b=squeeze(v1.ar.prday_pct(1,2,:,:)); p.z1=(a-b)./a/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w1.ar; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w1.tc; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w1.td; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w1.mc; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change of P99.9';
p.s2='percent change of AR P>=P99.9'; 
p.s3='percent change of TS P>=P99.9'; 
p.s4='percent change of TD P>=P99.9'; 
p.s5='percent change of MSC P>=P99.9';
p.s6='percent change of ALL P>=P99.9'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%delta_w500%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_w500_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=20;
a=squeeze(w1.ar.w500_av); b=squeeze(v1.ar.w500_av); p.z1=(a-b)./b/dTs*100;
v=v1.ar; a1=squeeze(v.w500_idavg); s1=squeeze(v.w500_idstd); n1=squeeze(v.id_sum); 
v=w1.ar; a2=squeeze(v.w500_idavg); s2=squeeze(v.w500_idstd); n2=squeeze(v.id_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.w500_idavg); s1=squeeze(v.w500_idstd); n1=squeeze(v.id_sum); 
v=w1.tc; a2=squeeze(v.w500_idavg); s2=squeeze(v.w500_idstd); n2=squeeze(v.id_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.w500_idavg); s1=squeeze(v.w500_idstd); n1=squeeze(v.id_sum); 
v=w1.td; a2=squeeze(v.w500_idavg); s2=squeeze(v.w500_idstd); n2=squeeze(v.id_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.w500_idavg); s1=squeeze(v.w500_idstd); n1=squeeze(v.id_sum); 
v=w1.mc; a2=squeeze(v.w500_idavg); s2=squeeze(v.w500_idstd); n2=squeeze(v.id_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean 500hPa omega';
p.s2='\Delta AR mean 500hPa omega'; 
p.s3='\Delta TS mean 500hPa omega'; 
p.s4='\Delta TD mean 500hPa omega'; 
p.s5='\Delta MCS mean 500hPa omega';
p.s6='\Delta AVG (AR+TS+TD+MCS) 500hPa omega'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_w500_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; I=1; no=10;
v=v1.ar; a1=squeeze(v.prday_pct(1,I,:,:)); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum);
v=w1.ar; a2=squeeze(v.prday_pct(1,I,:,:)); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum);
[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;%p.z1=(a2-a1)./a1/dTs*100;
v=v1.ar; a1=squeeze(v.w500_idavg_p99); s1=squeeze(v.w500_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.ar; a2=squeeze(v.w500_idavg_p99); s2=squeeze(v.w500_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.w500_idavg_p99); s1=squeeze(v.w500_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.tc; a2=squeeze(v.w500_idavg_p99); s2=squeeze(v.w500_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.w500_idavg_p99); s1=squeeze(v.w500_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.td; a2=squeeze(v.w500_idavg_p99); s2=squeeze(v.w500_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.w500_idavg_p99); s1=squeeze(v.w500_idstd_p99); n1=squeeze(v.id99_sum); 
v=w1.mc; a2=squeeze(v.w500_idavg_p99); s2=squeeze(v.w500_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6; %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change in Pr 99 percentile (P99)';
p.s2='percent change in \omega_{500} for AR (Pr>=P99)'; 
p.s3='percent change in \omega_{500} for TS (Pr>=P99)'; 
p.s4='percent change in \omega_{500} for TD (Pr>=P99)'; 
p.s5='percent change in \omega_{500} for MSC (Pr>=P99)';
p.s6='percent change in \omega_{500} for ALL (Pr>=P99)'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_w500_idavg_p999';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; no=5;
v=v1.ar; a1=squeeze(v.prday_pct(1,2,:,:)); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum);
v=w1.ar; a2=squeeze(v.prday_pct(1,2,:,:)); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum);
[p.z1,p.e1,p.pd1]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z1=p.pd1/dTs;%p.z1=(a2-a1)./a1/dTs*100;
v=v1.ar; a1=squeeze(v.w500_idavg_p999); s1=squeeze(v.w500_idstd_p999); n1=squeeze(v.id999_sum); 
v=w1.ar; a2=squeeze(v.w500_idavg_p999); s2=squeeze(v.w500_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.w500_idavg_p999); s1=squeeze(v.w500_idstd_p999); n1=squeeze(v.id999_sum); 
v=w1.tc; a2=squeeze(v.w500_idavg_p999); s2=squeeze(v.w500_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.w500_idavg_p999); s1=squeeze(v.w500_idstd_p999); n1=squeeze(v.id999_sum); 
v=w1.td; a2=squeeze(v.w500_idavg_p999); s2=squeeze(v.w500_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.w500_idavg_p999); s1=squeeze(v.w500_idstd_p999); n1=squeeze(v.id999_sum); 
v=w1.mc; a2=squeeze(v.w500_idavg_p999); s2=squeeze(v.w500_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6; %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change in Prec 99.9 percentile (P99.9)';
p.s2='percent change in \omega_{500} for AR (P>=P99.9)'; 
p.s3='percent change in \omega_{500} for TS (P>=P99.9)'; 
p.s4='percent change in \omega_{500} for TD (P>=P99.9)'; 
p.s5='percent change in \omega_{500} for MSC (P>=P99.9)';
p.s6='percent change in \omega_{500} for ALL (P>=P99.9)'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%delta LWCF%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_lwcf_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a =squeeze(w1.ar.lwcf_av);    b =squeeze(v1.ar.lwcf_av);    p.z1=(a-b)/dTs;
a =squeeze(w1.ar.lwcf_idwei); b =squeeze(v1.ar.lwcf_idwei); p.z2=(a-b)/dTs;
a =squeeze(w1.tc.lwcf_idwei); b =squeeze(v1.tc.lwcf_idwei); p.z3=(a-b)/dTs;
a =squeeze(w1.td.lwcf_idwei); b =squeeze(v1.td.lwcf_idwei); p.z4=(a-b)/dTs;
a =squeeze(w1.mc.lwcf_idwei); b =squeeze(v1.mc.lwcf_idwei); p.z5=(a-b)/dTs;
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean LW CRE';
p.s2='\Delta AR LW CRE'; 
p.s3='\Delta TS LW CRE'; 
p.s4='\Delta TD LW CRE'; 
p.s5='\Delta MCS LW CRE';
p.s6='\Delta LW CRE from AR+TS+TD+MCS'; p.s0='';
p.c1=[-1 1]; a=[-1 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_lwcf_idwei_frac';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a0=squeeze(w1.ar.lwcf_av);    b0=squeeze(v1.ar.lwcf_av);    p.z1=(a0-b0)/dTs;
a =squeeze(w1.ar.lwcf_idwei); b =squeeze(v1.ar.lwcf_idwei); p.z2=(a-b)./(a0-b0);
a =squeeze(w1.tc.lwcf_idwei); b =squeeze(v1.tc.lwcf_idwei); p.z3=(a-b)./(a0-b0);
a =squeeze(w1.td.lwcf_idwei); b =squeeze(v1.td.lwcf_idwei); p.z4=(a-b)./(a0-b0);
a =squeeze(w1.mc.lwcf_idwei); b =squeeze(v1.mc.lwcf_idwei); p.z5=(a-b)./(a0-b0);
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean LW CRE';
p.s2='\Delta AR LW CRE'; 
p.s3='\Delta TS LW CRE'; 
p.s4='\Delta TD LW CRE'; 
p.s5='\Delta MCS LW CRE';
p.s6='\Delta LW CRE from AR+TS+TD+MCS'; p.s0='';
p.c1=[-1 1]; a=[-1 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_per_K_lwcf_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=20;
a2=squeeze(w1.ar.lwcf_av); a1=squeeze(v1.ar.lwcf_av); p.z1=(a2-a1)/dTs;
v=v1.ar; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.ar; a2=squeeze(v.lwcf_idavg); s2=squeeze(v.lwcf_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.tc; a2=squeeze(v.lwcf_idavg); s2=squeeze(v.lwcf_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;
v=v1.td; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.td; a2=squeeze(v.lwcf_idavg); s2=squeeze(v.lwcf_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;
v=v1.mc; a1=squeeze(v.lwcf_idavg); s1=squeeze(v.lwcf_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.mc; a2=squeeze(v.lwcf_idavg); s2=squeeze(v.lwcf_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean LW CRE';
p.s2='\Delta AR mean LW CRE'; 
p.s3='\Delta TS mean LW CRE'; 
p.s4='\Delta TD mean LW CRE'; 
p.s5='\Delta MCS mean LW CRE';
p.s6='\Delta AVG (AR+TS+TD+MCS) LW CRE'; p.s0='';
p.c1=[-1 1]; a=[-2 2]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_per_K_lwcf_nonid_avg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=20; N=365*100;
a2=squeeze(w1.ar.lwcf_av); a1=squeeze(v1.ar.lwcf_av); p.z1=(a2-a1)/dTs;
v=v1.ar; a1=squeeze(v.lwcf_nonid_avg); s1=squeeze(v.lwcf_nonid_std); n1=squeeze(N-v.id_sum);%n1=squeeze(v.frqday);
v=w1.ar; a2=squeeze(v.lwcf_nonid_avg); s2=squeeze(v.lwcf_nonid_std); n2=squeeze(N-v.id_sum);%n2=squeeze(v.frqday);
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.lwcf_nonid_avg); s1=squeeze(v.lwcf_nonid_std); n1=squeeze(N-v.id_sum);%n1=squeeze(v.frqday);
v=w1.tc; a2=squeeze(v.lwcf_nonid_avg); s2=squeeze(v.lwcf_nonid_std); n2=squeeze(N-v.id_sum);%n2=squeeze(v.frqday);
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;
v=v1.td; a1=squeeze(v.lwcf_nonid_avg); s1=squeeze(v.lwcf_nonid_std); n1=squeeze(N-v.id_sum);%n1=squeeze(v.frqday);
v=w1.td; a2=squeeze(v.lwcf_nonid_avg); s2=squeeze(v.lwcf_nonid_std); n2=squeeze(N-v.id_sum);%n2=squeeze(v.frqday);
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;
v=v1.mc; a1=squeeze(v.lwcf_nonid_avg); s1=squeeze(v.lwcf_nonid_std); n1=squeeze(N-v.id_sum);%n1=squeeze(v.frqday);
v=w1.mc; a2=squeeze(v.lwcf_nonid_avg); s2=squeeze(v.lwcf_nonid_std); n2=squeeze(N-v.id_sum);%n2=squeeze(v.frqday);
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean LW CRE';
p.s2='\Delta non-AR mean LW CRE'; 
p.s3='\Delta non-TS mean LW CRE'; 
p.s4='\Delta non-TD mean LW CRE'; 
p.s5='\Delta non-MCS mean LW CRE';
p.s6='\Delta AVG non-(AR+TS+TD+MCS) LW CRE'; p.s0='';
p.c1=[-1 1]; a=[-2 2]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%delta SWCF%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_swcf_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a =squeeze(w1.ar.swcf_av);    b =squeeze(v1.ar.swcf_av);    p.z1=(a-b)/dTs;
a =squeeze(w1.ar.swcf_idwei); b =squeeze(v1.ar.swcf_idwei); p.z2=(a-b)/dTs;
a =squeeze(w1.tc.swcf_idwei); b =squeeze(v1.tc.swcf_idwei); p.z3=(a-b)/dTs;
a =squeeze(w1.td.swcf_idwei); b =squeeze(v1.td.swcf_idwei); p.z4=(a-b)/dTs;
a =squeeze(w1.mc.swcf_idwei); b =squeeze(v1.mc.swcf_idwei); p.z5=(a-b)/dTs;
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean SW CRE';
p.s2='\Delta AR SW CRE'; 
p.s3='\Delta TS SW CRE'; 
p.s4='\Delta TD SW CRE'; 
p.s5='\Delta MCS SW CRE';
p.s6='\Delta SW CRE from AR+TS+TD+MCS'; p.s0='';
p.c1=[-1 1]; a=[-1 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_swcf_idwei_frac';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a0=squeeze(w1.ar.swcf_av);    b0=squeeze(v1.ar.swcf_av);    p.z1=(a0-b0)/dTs;
a =squeeze(w1.ar.swcf_idwei); b =squeeze(v1.ar.swcf_idwei); p.z2=(a-b)./(a0-b0);
a =squeeze(w1.tc.swcf_idwei); b =squeeze(v1.tc.swcf_idwei); p.z3=(a-b)./(a0-b0);
a =squeeze(w1.td.swcf_idwei); b =squeeze(v1.td.swcf_idwei); p.z4=(a-b)./(a0-b0);
a =squeeze(w1.mc.swcf_idwei); b =squeeze(v1.mc.swcf_idwei); p.z5=(a-b)./(a0-b0);
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean SW CRE';
p.s2='\Delta AR SW CRE'; 
p.s3='\Delta TS SW CRE'; 
p.s4='\Delta TD SW CRE'; 
p.s5='\Delta MCS SW CRE';
p.s6='\Delta SW CRE from AR+TS+TD+MCS'; p.s0='';
p.c1=[-1 1]; a=[-1 1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_per_K_swcf_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=20;
a2=squeeze(w1.ar.swcf_av); a1=squeeze(v1.ar.swcf_av); p.z1=(a2-a1)/dTs;
v=v1.ar; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.ar; a2=squeeze(v.swcf_idavg); s2=squeeze(v.swcf_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.tc; a2=squeeze(v.swcf_idavg); s2=squeeze(v.swcf_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;
v=v1.td; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.td; a2=squeeze(v.swcf_idavg); s2=squeeze(v.swcf_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;
v=v1.mc; a1=squeeze(v.swcf_idavg); s1=squeeze(v.swcf_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.mc; a2=squeeze(v.swcf_idavg); s2=squeeze(v.swcf_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean SW CRE';
p.s2='\Delta AR mean SW CRE'; 
p.s3='\Delta TS mean SW CRE'; 
p.s4='\Delta TD mean SW CRE'; 
p.s5='\Delta MCS mean SW CRE';
p.s6='\Delta AVG (AR+TS+TD+MCS) SW CRE'; p.s0='';
p.c1=[-1 1]; a=[-2 2]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_per_K_swcf_nonid_avg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=20; N=v.nyr*365
a2=squeeze(w1.ar.swcf_av); a1=squeeze(v1.ar.swcf_av); p.z1=(a2-a1)/dTs;
v=v1.ar; a1=squeeze(v.swcf_nonid_avg); s1=squeeze(v.swcf_nonid_std); n1=N-squeeze(v.id_sum);
v=w1.ar; a2=squeeze(v.swcf_nonid_avg); s2=squeeze(v.swcf_nonid_std); n2=N-squeeze(v.id_sum);
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.swcf_nonid_avg); s1=squeeze(v.swcf_nonid_std); n1=N-squeeze(v.id_sum);
v=w1.tc; a2=squeeze(v.swcf_nonid_avg); s2=squeeze(v.swcf_nonid_std); n2=N-squeeze(v.id_sum);
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;
v=v1.td; a1=squeeze(v.swcf_nonid_avg); s1=squeeze(v.swcf_nonid_std); n1=N-squeeze(v.id_sum);
v=w1.td; a2=squeeze(v.swcf_nonid_avg); s2=squeeze(v.swcf_nonid_std); n2=N-squeeze(v.id_sum);
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;
v=v1.mc; a1=squeeze(v.swcf_nonid_avg); s1=squeeze(v.swcf_nonid_std); n1=N-squeeze(v.id_sum);
v=w1.mc; a2=squeeze(v.swcf_nonid_avg); s2=squeeze(v.swcf_nonid_std); n2=N-squeeze(v.id_sum);
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean SW CRE';
p.s2='\Delta AR mean SW CRE'; 
p.s3='\Delta TS mean SW CRE'; 
p.s4='\Delta TD mean SW CRE'; 
p.s5='\Delta MCS mean SW CRE';
p.s6='\Delta AVG (AR+TS+TD+MCS) SW CRE'; p.s0='';
p.c1=[-1 1]; a=[-2 2]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%TAS%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_per_K_tas_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=1;
a2=squeeze(w1.ar.tas_av); a1=squeeze(v1.ar.tas_av); p.z1=(a2-a1)/dTs;
v=v1.ar; a1=squeeze(v.tas_idavg); s1=squeeze(v.tas_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.ar; a2=squeeze(v.tas_idavg); s2=squeeze(v.tas_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.z2/dTs;
v=v1.tc; a1=squeeze(v.tas_idavg); s1=squeeze(v.tas_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.tc; a2=squeeze(v.tas_idavg); s2=squeeze(v.tas_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.z3/dTs;
v=v1.td; a1=squeeze(v.tas_idavg); s1=squeeze(v.tas_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.td; a2=squeeze(v.tas_idavg); s2=squeeze(v.tas_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.z4/dTs;
v=v1.mc; a1=squeeze(v.tas_idavg); s1=squeeze(v.tas_idstd); n1=squeeze(v.id_sum);%n1=squeeze(v.frqday);
v=w1.mc; a2=squeeze(v.tas_idavg); s2=squeeze(v.tas_idstd); n2=squeeze(v.id_sum);%n2=squeeze(v.frqday);
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.z5/dTs;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean SW CRE';
p.s2='\Delta AR mean SW CRE'; 
p.s3='\Delta TS mean SW CRE'; 
p.s4='\Delta TD mean SW CRE'; 
p.s5='\Delta MCS mean SW CRE';
p.s6='\Delta AVG (AR+TS+TD+MCS) SW CRE'; p.s0='';
p.c1=[-1.5 1.5]; a=[-1.5 1.5]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: P4K_4xCO2 minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
p.z1=squeeze(w2.ar.prday_av   -v1.ar.prday_av)/dTs;
p.z2=squeeze(w2.ar.prday_idwei-v1.ar.prday_idwei)/dTs;   
p.z3=squeeze(w2.tc.prday_idwei-v1.tc.prday_idwei)/dTs;
p.z4=squeeze(w2.td.prday_idwei-v1.td.prday_idwei)/dTs;
p.z5=squeeze(w2.mc.prday_idwei-v1.mc.prday_idwei)/dTs;    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean precipitation';
p.s2='\Delta AR precipitation'; 
p.s3='\Delta TS precipitation'; 
p.s4='\Delta TD precipitation'; 
p.s5='\Delta MCS precipitation';
p.s6='\Delta SUM=AR+TS+TD+MCS precipitation'; p.s0='';
p.c1=[-0.4 0.4]; a=[-0.2 0.2]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=[-0.4 0.4]; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_idwei_frac';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a0=squeeze(w2.ar.prday_av);    b0=squeeze(v1.ar.prday_av);    p.z1=(a0-b0)./b0/dTs*100;
a =squeeze(w2.ar.prday_idwei); b =squeeze(v1.ar.prday_idwei); p.z2=(a./a0-b./b0)*100;
a =squeeze(w2.tc.prday_idwei); b =squeeze(v1.tc.prday_idwei); p.z3=(a./a0-b./b0)*100;
a =squeeze(w2.td.prday_idwei); b =squeeze(v1.td.prday_idwei); p.z4=(a./a0-b./b0)*100;
a =squeeze(w2.mc.prday_idwei); b =squeeze(v1.mc.prday_idwei); p.z5=(a./a0-b./b0)*100;
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='percent change of annual mean P';
p.s2='\Delta fraction of P from AR'; 
p.s3='\Delta fraction of P from TS'; 
p.s4='\Delta fraction of P from TD'; 
p.s5='\Delta fraction of P from MCS';
p.s6='\Delta fraction of P from AR+TS+TD+MCS'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_frqday';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-0.1: 0.005: 0.1]; p.opt=2; p.nn=64; p.c='k';
p.z1=squeeze(w2.ar.prday_fqwet(1,:,:,2) - v1.ar.prday_fqwet(1,:,:,2));
p.z2=squeeze(w2.ar.frqday - v1.ar.frqday);
p.z3=squeeze(w2.tc.frqday - v1.tc.frqday);
p.z4=squeeze(w2.td.frqday - v1.td.frqday);
p.z5=squeeze(w2.mc.frqday - v1.mc.frqday);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='\Delta frequency of wet day';
p.s2='\Delta frequency of AR days'; 
p.s3='\Delta frequency of TS days'; 
p.s4='\Delta frequency of TD days'; 
p.s5='\Delta frequency of MCS days';
p.s6='\Delta SUM=AR+TS+TD+MCS days'; p.s0='';
p.c1=[-0.1 0.1]; a=[-0.04 0.04]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_fp99_from_id';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k';
a=squeeze(w2.ar.prday_pct(:,1,:,:)); b=squeeze(v1.ar.prday_pct(:,1,:,:));p.z1=a-b;
a=squeeze(w2.ar.prday_fp99_from_id); b=squeeze(v1.ar.prday_fp99_from_id);p.z2=a-b;
a=squeeze(w2.tc.prday_fp99_from_id); b=squeeze(v1.tc.prday_fp99_from_id);p.z3=a-b;
a=squeeze(w2.td.prday_fp99_from_id); b=squeeze(v1.td.prday_fp99_from_id);p.z4=a-b;
a=squeeze(w2.mc.prday_fp99_from_id); b=squeeze(v1.mc.prday_fp99_from_id);p.z5=a-b;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3);  p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='\Delta 99 percentile of daily precip';
p.s2='\Delta fraction from AR'; 
p.s3='\Delta fraction from TS'; 
p.s4='\Delta fraction from TD'; 
p.s5='\Delta fraction from MCS';
p.s6='\Delta AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[-10 10]; a=[-0.1 0.1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_fp999_from_id';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k';
a=squeeze(w2.ar.prday_pct(:,2,:,:));  b=squeeze(v1.ar.prday_pct(:,2,:,:));p.z1=a-b;
a=squeeze(w2.ar.prday_fp999_from_id); b=squeeze(v1.ar.prday_fp999_from_id);p.z2=a-b;
a=squeeze(w2.tc.prday_fp999_from_id); b=squeeze(v1.tc.prday_fp999_from_id);p.z3=a-b;
a=squeeze(w2.td.prday_fp999_from_id); b=squeeze(v1.td.prday_fp999_from_id);p.z4=a-b;
a=squeeze(w2.mc.prday_fp999_from_id); b=squeeze(v1.mc.prday_fp999_from_id);p.z5=a-b;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3);  p.z0=p.z6;
p=smoothp(p,5,5,'omitnan','shrink');
p.s1='\Delta 99.9 percentile of daily precip';
p.s2='\Delta fraction from AR'; 
p.s3='\Delta fraction from TS'; 
p.s4='\Delta fraction from TD'; 
p.s5='\Delta fraction from MCS';
p.s6='\Delta AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[-20 20]; a=[-0.1 0.1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=20;
a=squeeze(w2.ar.prday_av); b=squeeze(v1.ar.prday_av); p.z1=(a-b)./b/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w2.ar; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w2.tc; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w2.td; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w2.mc; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean precipitation';
p.s2='\Delta AR mean precipitation'; 
p.s3='\Delta TS mean precipitation'; 
p.s4='\Delta TD mean precipitation'; 
p.s5='\Delta MCS mean precipitation';
p.s6='\Delta AVG (AR+TS+TD+MCS) precipitation'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; no=10;
a=squeeze(w2.ar.prday_pct(1,1,:,:)); b=squeeze(v1.ar.prday_pct(1,1,:,:)); p.z1=(a-b)./a/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w2.ar; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w2.tc; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w2.td; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w2.mc; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change of P99';
p.s2='percent change of AR P>=P99'; 
p.s3='percent change of TS P>=P99'; 
p.s4='percent change of TD P>=P99'; 
p.s5='percent change of MSC P>=P99';
p.s6='percent change of ALL P>=P99'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='p4K_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg_p999';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; no=1;
a=squeeze(w2.ar.prday_pct(1,2,:,:)); b=squeeze(v1.ar.prday_pct(1,2,:,:)); p.z1=(a-b)./a/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w2.ar; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w2.tc; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w2.td; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w2.mc; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change of P99.9';
p.s2='percent change of AR P>=P99.9'; 
p.s3='percent change of TS P>=P99.9'; 
p.s4='percent change of TD P>=P99.9'; 
p.s5='percent change of MSC P>=P99.9';
p.s6='percent change of ALL P>=P99.9'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: 4xCO2 minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
p.z1=squeeze(c1.ar.prday_av   -v1.ar.prday_av)/dTs;
p.z2=squeeze(c1.ar.prday_idwei-v1.ar.prday_idwei)/dTs;   
p.z3=squeeze(c1.tc.prday_idwei-v1.tc.prday_idwei)/dTs;
p.z4=squeeze(c1.td.prday_idwei-v1.td.prday_idwei)/dTs;
p.z5=squeeze(c1.mc.prday_idwei-v1.mc.prday_idwei)/dTs;    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean precipitation';
p.s2='\Delta AR precipitation'; 
p.s3='\Delta TS precipitation'; 
p.s4='\Delta TD precipitation'; 
p.s5='\Delta MCS precipitation';
p.s6='\Delta SUM=AR+TS+TD+MCS precipitation'; p.s0='';
p.c1=[-0.4 0.4]; a=[-0.2 0.2]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=[-0.4 0.4]; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_idwei_frac';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a0=squeeze(c1.ar.prday_av);    b0=squeeze(v1.ar.prday_av);    p.z1=(a0-b0)./b0/dTs*100;
a =squeeze(c1.ar.prday_idwei); b =squeeze(v1.ar.prday_idwei); p.z2=(a./a0-b./b0)*100;
a =squeeze(c1.tc.prday_idwei); b =squeeze(v1.tc.prday_idwei); p.z3=(a./a0-b./b0)*100;
a =squeeze(c1.td.prday_idwei); b =squeeze(v1.td.prday_idwei); p.z4=(a./a0-b./b0)*100;
a =squeeze(c1.mc.prday_idwei); b =squeeze(v1.mc.prday_idwei); p.z5=(a./a0-b./b0)*100;
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='percent change of annual mean P';
p.s2='\Delta fraction of P from AR'; 
p.s3='\Delta fraction of P from TS'; 
p.s4='\Delta fraction of P from TD'; 
p.s5='\Delta fraction of P from MCS';
p.s6='\Delta fraction of P from AR+TS+TD+MCS'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_frqday';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-0.1: 0.005: 0.1]; p.opt=2; p.nn=64; p.c='k';
p.z1=squeeze(c1.ar.prday_fqwet(1,:,:,2) - v1.ar.prday_fqwet(1,:,:,2));
p.z2=squeeze(c1.ar.frqday - v1.ar.frqday);
p.z3=squeeze(c1.tc.frqday - v1.tc.frqday);
p.z4=squeeze(c1.td.frqday - v1.td.frqday);
p.z5=squeeze(c1.mc.frqday - v1.mc.frqday);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta frequency of wet day';
p.s2='\Delta frequency of AR days'; 
p.s3='\Delta frequency of TS days'; 
p.s4='\Delta frequency of TD days'; 
p.s5='\Delta frequency of MCS days';
p.s6='\Delta SUM=AR+TS+TD+MCS days'; p.s0='';
p.c1=[-0.1 0.1]; a=[-0.04 0.04]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_fp99_from_id';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k';
a=squeeze(c1.ar.prday_pct(:,1,:,:)); b=squeeze(v1.ar.prday_pct(:,1,:,:));p.z1=a-b;
a=squeeze(c1.ar.prday_fp99_from_id); b=squeeze(v1.ar.prday_fp99_from_id);p.z2=a-b;
a=squeeze(c1.tc.prday_fp99_from_id); b=squeeze(v1.tc.prday_fp99_from_id);p.z3=a-b;
a=squeeze(c1.td.prday_fp99_from_id); b=squeeze(v1.td.prday_fp99_from_id);p.z4=a-b;
a=squeeze(c1.mc.prday_fp99_from_id); b=squeeze(v1.mc.prday_fp99_from_id);p.z5=a-b;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3);  p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='\Delta 99 percentile of daily precip';
p.s2='\Delta fraction from AR'; 
p.s3='\Delta fraction from TS'; 
p.s4='\Delta fraction from TD'; 
p.s5='\Delta fraction from MCS';
p.s6='\Delta AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[-10 10]; a=[-0.1 0.1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_fp999_from_id';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k';
a=squeeze(c1.ar.prday_pct(:,2,:,:));  b=squeeze(v1.ar.prday_pct(:,2,:,:));p.z1=a-b;
a=squeeze(c1.ar.prday_fp999_from_id); b=squeeze(v1.ar.prday_fp999_from_id);p.z2=a-b;
a=squeeze(c1.tc.prday_fp999_from_id); b=squeeze(v1.tc.prday_fp999_from_id);p.z3=a-b;
a=squeeze(c1.td.prday_fp999_from_id); b=squeeze(v1.td.prday_fp999_from_id);p.z4=a-b;
a=squeeze(c1.mc.prday_fp999_from_id); b=squeeze(v1.mc.prday_fp999_from_id);p.z5=a-b;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3);  p.z0=p.z6;
p=smoothp(p,5,5,'omitnan','shrink');
p.s1='\Delta 99.9 percentile of daily precip';
p.s2='\Delta fraction from AR'; 
p.s3='\Delta fraction from TS'; 
p.s4='\Delta fraction from TD'; 
p.s5='\Delta fraction from MCS';
p.s6='\Delta AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[-20 20]; a=[-0.1 0.1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar;  p.expn='4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=20;
a=squeeze(c1.ar.prday_av); b=squeeze(v1.ar.prday_av); p.z1=(a-b)./b/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=c1.ar; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=c1.tc; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=c1.td; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=c1.mc; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean precipitation';
p.s2='\Delta AR mean precipitation'; 
p.s3='\Delta TS mean precipitation'; 
p.s4='\Delta TD mean precipitation'; 
p.s5='\Delta MCS mean precipitation';
p.s6='\Delta AVG (AR+TS+TD+MCS) precipitation'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar;  p.expn='4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; no=20;
a=squeeze(c1.ar.prday_pct(1,1,:,:)); b=squeeze(v1.ar.prday_pct(1,1,:,:)); p.z1=(a-b)./a/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=c1.ar; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=c1.tc; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=c1.td; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=c1.mc; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change of P99';
p.s2='percent change of AR P>=P99'; 
p.s3='percent change of TS P>=P99'; 
p.s4='percent change of TD P>=P99'; 
p.s5='percent change of MSC P>=P99';
p.s6='percent change of ALL P>=P99'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar;  p.expn='4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg_p999';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; no=1;
a=squeeze(c1.ar.prday_pct(1,2,:,:)); b=squeeze(v1.ar.prday_pct(1,2,:,:)); p.z1=(a-b)./a/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=c1.ar; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=c1.tc; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=c1.td; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=c1.mc; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,5,5,'omitnan','shrink');
p.s1='percent change of P99.9';
p.s2='percent change of AR P>=P99.9'; 
p.s3='percent change of TS P>=P99.9'; 
p.s4='percent change of TD P>=P99.9'; 
p.s5='percent change of MSC P>=P99.9';
p.s6='percent change of ALL P>=P99.9'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: warm_4xCO2 minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='warm_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_idwei';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
p.z1=squeeze(w3.ar.prday_av   -v1.ar.prday_av)/dTs;
p.z2=squeeze(w3.ar.prday_idwei-v1.ar.prday_idwei)/dTs;   
p.z3=squeeze(w3.tc.prday_idwei-v1.tc.prday_idwei)/dTs;
p.z4=squeeze(w3.td.prday_idwei-v1.td.prday_idwei)/dTs;
p.z5=squeeze(w3.mc.prday_idwei-v1.mc.prday_idwei)/dTs;    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean precipitation';
p.s2='\Delta AR precipitation'; 
p.s3='\Delta TS precipitation'; 
p.s4='\Delta TD precipitation'; 
p.s5='\Delta MCS precipitation';
p.s6='\Delta SUM=AR+TS+TD+MCS precipitation'; p.s0='';
p.c1=[-0.4 0.4]; a=[-0.2 0.2]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=[-0.4 0.4]; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='warm_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_idwei_frac';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52;
a0=squeeze(w3.ar.prday_av);    b0=squeeze(v1.ar.prday_av);    p.z1=(a0-b0)./b0/dTs*100;
a =squeeze(w3.ar.prday_idwei); b =squeeze(v1.ar.prday_idwei); p.z2=(a./a0-b./b0)*100;
a =squeeze(w3.tc.prday_idwei); b =squeeze(v1.tc.prday_idwei); p.z3=(a./a0-b./b0)*100;
a =squeeze(w3.td.prday_idwei); b =squeeze(v1.td.prday_idwei); p.z4=(a./a0-b./b0)*100;
a =squeeze(w3.mc.prday_idwei); b =squeeze(v1.mc.prday_idwei); p.z5=(a./a0-b./b0)*100;
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='percent change of annual mean P';
p.s2='\Delta fraction of P from AR'; 
p.s3='\Delta fraction of P from TS'; 
p.s4='\Delta fraction of P from TD'; 
p.s5='\Delta fraction of P from MCS';
p.s6='\Delta fraction of P from AR+TS+TD+MCS'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a; 
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='warm_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_frqday';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-0.1: 0.005: 0.1]; p.opt=2; p.nn=64; p.c='k';
p.z1=squeeze(w3.ar.prday_fqwet(1,:,:,2) - v1.ar.prday_fqwet(1,:,:,2));
p.z2=squeeze(w3.ar.frqday - v1.ar.frqday);
p.z3=squeeze(w3.tc.frqday - v1.tc.frqday);
p.z4=squeeze(w3.td.frqday - v1.td.frqday);
p.z5=squeeze(w3.mc.frqday - v1.mc.frqday);    
p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='\Delta frequency of wet day';
p.s2='\Delta frequency of AR days'; 
p.s3='\Delta frequency of TS days'; 
p.s4='\Delta frequency of TD days'; 
p.s5='\Delta frequency of MCS days';
p.s6='\Delta SUM=AR+TS+TD+MCS days'; p.s0='';
p.c1=[-0.1 0.1]; a=[-0.04 0.04]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='warm_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_fp99_from_id';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k';
a=squeeze(w3.ar.prday_pct(:,1,:,:)); b=squeeze(v1.ar.prday_pct(:,1,:,:));p.z1=a-b;
a=squeeze(w3.ar.prday_fp99_from_id); b=squeeze(v1.ar.prday_fp99_from_id);p.z2=a-b;
a=squeeze(w3.tc.prday_fp99_from_id); b=squeeze(v1.tc.prday_fp99_from_id);p.z3=a-b;
a=squeeze(w3.td.prday_fp99_from_id); b=squeeze(v1.td.prday_fp99_from_id);p.z4=a-b;
a=squeeze(w3.mc.prday_fp99_from_id); b=squeeze(v1.mc.prday_fp99_from_id);p.z5=a-b;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3);  p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='\Delta 99 percentile of daily precip';
p.s2='\Delta fraction from AR'; 
p.s3='\Delta fraction from TS'; 
p.s4='\Delta fraction from TD'; 
p.s5='\Delta fraction from MCS';
p.s6='\Delta AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[-10 10]; a=[-0.1 0.1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='warm_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='del_prday_fp999_from_id';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-1:0.01:1]; p.opt=2; p.nn=64; p.c='k';
a=squeeze(w3.ar.prday_pct(:,2,:,:));  b=squeeze(v1.ar.prday_pct(:,2,:,:));p.z1=a-b;
a=squeeze(w3.ar.prday_fp999_from_id); b=squeeze(v1.ar.prday_fp999_from_id);p.z2=a-b;
a=squeeze(w3.tc.prday_fp999_from_id); b=squeeze(v1.tc.prday_fp999_from_id);p.z3=a-b;
a=squeeze(w3.td.prday_fp999_from_id); b=squeeze(v1.td.prday_fp999_from_id);p.z4=a-b;
a=squeeze(w3.mc.prday_fp999_from_id); b=squeeze(v1.mc.prday_fp999_from_id);p.z5=a-b;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3);  p.z0=p.z6;
p=smoothp(p,5,5,'omitnan','shrink');
p.s1='\Delta 99.9 percentile of daily precip';
p.s2='\Delta fraction from AR'; 
p.s3='\Delta fraction from TS'; 
p.s4='\Delta fraction from TD'; 
p.s5='\Delta fraction from MCS';
p.s6='\Delta AVG (AR+TS+TD+MCS)'; p.s0='';
p.c1=[-20 20]; a=[-0.1 0.1]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='warm_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-4:0.04:4]; p.opt=2; p.nn=64; p.c='k'; dTs=4.52; no=20;
a=squeeze(w3.ar.prday_av); b=squeeze(v1.ar.prday_av); p.z1=(a-b)./b/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w3.ar; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w3.tc; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w3.td; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg); s1=squeeze(v.prday_idstd); n1=squeeze(v.id_sum); 
v=w3.mc; a2=squeeze(v.prday_idavg); s2=squeeze(v.prday_idstd); n2=squeeze(v.id_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); p.z0=p.z6;
p=smoothp(p,1,1,'omitnan','shrink');
p.s1='\Delta annual mean precipitation';
p.s2='\Delta AR mean precipitation'; 
p.s3='\Delta TS mean precipitation'; 
p.s4='\Delta TD mean precipitation'; 
p.s5='\Delta MCS mean precipitation';
p.s6='\Delta AVG (AR+TS+TD+MCS) precipitation'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p)
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='warm_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg_p99';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; no=20;
a=squeeze(w3.ar.prday_pct(1,1,:,:)); b=squeeze(v1.ar.prday_pct(1,1,:,:)); p.z1=(a-b)./a/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w3.ar; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w3.tc; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w3.td; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg_p99); s1=squeeze(v.prday_idstd_p99); n1=squeeze(v.id99_sum); 
v=w3.mc; a2=squeeze(v.prday_idavg_p99); s2=squeeze(v.prday_idstd_p99); n2=squeeze(v.id99_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change of P99';
p.s2='percent change of AR P>=P99'; 
p.s3='percent change of TS P>=P99'; 
p.s4='percent change of TD P>=P99'; 
p.s5='percent change of MSC P>=P99';
p.s6='percent change of ALL P>=P99'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
v=v1.ar; p.expn='warm_4xCO2_minus_ctl';
p.lm=v.lm; p.x=v.lon; p.y=v.lat; p.vname='percent_del_per_K_prday_idavg_p999';
lat0=-30; p.j1=max(find(v.lat<-lat0)); p.j2=min(find(v.lat>lat0));
p.aa=squeeze(v1.ar.aa); p.id=~isnan(p.aa); p.id(p.j1:p.j2,:)=0; id=p.id;
p.cm=[-20:0.02:20]; p.opt=1; p.nn=64; p.c='k'; dTs=4.52; no=1;
a=squeeze(w3.ar.prday_pct(1,2,:,:)); b=squeeze(v1.ar.prday_pct(1,2,:,:)); p.z1=(a-b)./a/dTs*100;
v=v1.ar; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w3.ar; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z2,p.e2,p.pd2]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z2=p.pd2/dTs;
v=v1.tc; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w3.tc; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z3,p.e3,p.pd3]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z3=p.pd3/dTs;;
v=v1.td; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w3.td; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z4,p.e4,p.pd4]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z4=p.pd4/dTs;;
v=v1.mc; a1=squeeze(v.prday_idavg_p999); s1=squeeze(v.prday_idstd_p999); n1=squeeze(v.id999_sum); 
v=w3.mc; a2=squeeze(v.prday_idavg_p999); s2=squeeze(v.prday_idstd_p999); n2=squeeze(v.id999_sum); 
[p.z5,p.e5,p.pd5]=compute_diff(a1,s1,n1,a2,s2,n2,no); p.z5=p.pd5/dTs;;
clear a; a(:,:,1)=p.z2; a(:,:,2)=p.z3; a(:,:,3)=p.z4; a(:,:,4)=p.z5;
p.z6=nanmean(a,3); %p.z6=p.z2+p.z3+p.z4+p.z5; p.z0=p.z6;
p=smoothp(p,3,3,'omitnan','shrink');
p.s1='percent change of P99.9';
p.s2='percent change of AR P>=P99.9'; 
p.s3='percent change of TS P>=P99.9'; 
p.s4='percent change of TD P>=P99.9'; 
p.s5='percent change of MSC P>=P99.9';
p.s6='percent change of ALL P>=P99.9'; p.s0='';
p.c1=[-10 10]; a=[-10 10]; p.c2=a; p.c3=a; p.c4=a; p.c5=a; p.c6=a;
plot_2d_6panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%







v=v1.ar; figure; pcolor(v.lon,v.lat,v.prday_fp99_from_id); shading flat; colorbar;
v=v1.tc; figure; pcolor(v.lon,v.lat,v.prday_fp99_from_id); shading flat; colorbar;

z=squeeze(v1.tc.frqday); 
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar;

z=squeeze(v1.ar.prday_idwei); 
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar;
z=squeeze(v1.tc.prday_idwei); 
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar;
z=squeeze(v1.td.prday_idwei); 
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar;
z=squeeze(v1.mc.prday_idwei); 
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar;


z=squeeze(v1.tc.prday_idavg); 
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar;

z=w1.ar.prday_fp99_from_id-v1.ar.prday_fp99_from_id; 
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar; caxis([-0.2 0.2]);
z=w1.tc.prday_fp99_from_id-v1.tc.prday_fp99_from_id;
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar; caxis([-0.2 0.2]);
z=w1.mc.prday_fp99_from_id-v1.mc.prday_fp99_from_id;
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar; caxis([-0.2 0.2]);

z=w1.ar.prday_idavg-v1.ar.prday_idavg; z=squeeze(z);
z=v1.mc.prday_idavg; z=squeeze(z);
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar; caxis([0 50]);
z=w1.tc.prday_idavg_p99-v1.tc.prday_idavg_p99; z=squeeze(z);
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar; caxis([-50 50]);
z=w1.mc.prday_idavg_p99-v1.mc.prday_idavg_p99; z=squeeze(z);
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar; caxis([-50 50]);

z=w1.ar.prday_idavg_p99-v1.ar.prday_idavg_p99; z=squeeze(z);
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar; caxis([-50 50]);
z=w1.tc.prday_idavg_p99-v1.tc.prday_idavg_p99; z=squeeze(z);
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar; caxis([-50 50]);
z=w1.mc.prday_idavg_p99-v1.mc.prday_idavg_p99; z=squeeze(z);
figure; pcolor(v.lon,v.lat,z); shading flat; colorbar; caxis([-50 50]);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: mean precip P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_avg_p4k_climo');str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 15]; p.cs1=[0 15]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.prday_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.prday_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: mean precip Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_avg_future_present'); str='-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 15]; p.cs1=[0 15]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.prday_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.prday_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: AR-AVG precip P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 15]; p.cs1=[0 15]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.prday_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.prday_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: AR-AVG precip Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 15]; p.cs1=[0 15]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.prday_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.prday_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: AR-AVG-P99 precip P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_aravg_p99_p4k_climo');str='-AR-AVG-P99';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.prday_aravg_p99); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.prday_aravg_p99); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: AR-AVG-P99 precip Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_aravg_p99_future_present');str='-AR-AVG-P99';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.prday_aravg_p99); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.prday_aravg_p99); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: AR-AVG-P999 precip P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_aravg_p999_p4k_climo');str='-AR-AVG-P999';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.prday_aravg_p999); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.prday_aravg_p999); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: AR-AVG-P999 precip Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_aravg_p999_future_present');str='-AR-AVG-P999';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.prday_aravg_p999); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.prday_aravg_p999); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: NONAR-AVG-P99 precip P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_nonar_p99_p4k_climo');str='-NONAR-AVG-P99';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.prday_nonar_p99); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.prday_nonar_p99); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: Fig NONAR-AVG-P99 precip Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_nonar_p99_future_present');str='-NONAR-AVG-P99';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.prday_nonar_p99); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.prday_nonar_p99); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: Fig NONAR-AVG-P999 precip P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_nonar_p999_p4k_climo');str='-NONAR-AVG-P999';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.prday_nonar_p999); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.prday_nonar_p999); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: Fig NONAR-AVG-P999 precip Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_nonar_p999_future_present');str='-NONAR-AVG-P999';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.prday_aravg_p999); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.prday_aravg_p999); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVT: AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVT';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[50 500]; p.cs1=[50 500]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.ivt_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.ivt_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVT: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVT';p.vname=strcat(vname,'_avg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[50 500]; p.cs1=[50 500]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.ivt_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.ivt_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVTX: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVT';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[150 900]; p.cs1=[150 900]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.ivt_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.ivt_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVT: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVT';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[150 900]; p.cs1=[150 900]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.ivt_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.ivt_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p);
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVTY: AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVTY';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[-120 120]; p.cs1=[-120 120]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.ivty_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.ivty_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVTY: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVTY';p.vname=strcat(vname,'_avg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[-120 120]; p.cs1=[-120 120]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.ivty_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.ivty_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVTY: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVTY';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[-300 300]; p.cs1=[-300 300]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.ivty_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.ivty_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVTY: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVTY';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[-300 300]; p.cs1=[-300 300]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.ivty_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.ivty_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVTX: AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVTX';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[-400 400]; p.cs1=[-400 400]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.ivtx_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.ivtx_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVTX: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVTX';p.vname=strcat(vname,'_avg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[-400 400]; p.cs1=[-400 400]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.ivtx_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.ivtx_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVTX: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVTX';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[-400 400]; p.cs1=[-400 400]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.ivtx_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.ivtx_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: IVTY: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='IVTX';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[-400 400]; p.cs1=[-400 400]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.ivtx_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.ivtx_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: PRW: AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='PRW';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 80]; p.cs1=[0 80]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.prw_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.prw_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: PRW: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='PRW';p.vname=strcat(vname,'_avg_future_present'); str='-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 80]; p.cs1=[0 80]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.prw_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.prw_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: PRW: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='PRW';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 80]; p.cs1=[0 80]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.prw_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.prw_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: PRW: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='PRW';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 80]; p.cs1=[0 80]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.prw_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.prw_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: LWCF: AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='LWCF';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 80]; p.cs1=[0 80]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.lwcf_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.lwcf_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: LWCF: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='LWCF';p.vname=strcat(vname,'_avg_future_present'); str='-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 80]; p.cs1=[0 80]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.lwcf_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.lwcf_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: LWCF: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='LWCF';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 80]; p.cs1=[0 80]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.lwcf_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.lwcf_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: PRW: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='LWCF';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 80]; p.cs1=[0 80]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.lwcf_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.lwcf_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: SWCF: AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='SWCF';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[-100 50]; p.cs1=[-100 50]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.swcf_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.swcf_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: SWCF: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='SWCF';p.vname=strcat(vname,'_avg_future_present'); str='-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[-100 50]; p.cs1=[-100 50]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.swcf_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.swcf_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: SWCF: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='SWCF';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[-100 50]; p.cs1=[-100 50]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.swcf_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.swcf_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: SWCF: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='SWCF';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[-100 50]; p.cs1=[-100 50]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.swcf_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.swcf_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: : RLUT AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='RLUT';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[150 300]; p.cs1=[150 300]; p.cs2=[-5 5];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.rlut_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.rlut_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: RLUT: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='RLUT';p.vname=strcat(vname,'_avg_future_present'); str='-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[150 300]; p.cs1=[150 300]; p.cs2=[-5 5];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.rlut_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.rlut_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: RLUT: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='RLUT';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[150 300]; p.cs1=[150 300]; p.cs2=[-5 5];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.rlut_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.rlut_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: RLUT: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='RLUT';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[150 300]; p.cs1=[150 300]; p.cs2=[-5 5];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.rlut_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.rlut_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: : RSUT AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='RSUT';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.rsut_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.rsut_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: RSUT: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='RSUT';p.vname=strcat(vname,'_avg_future_present'); str='-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.rsut_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.rsut_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: RSUT: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='RSUT';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.rsut_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.rsut_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: RSUT: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='RSUT';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 150]; p.cs1=[0 150]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.rsut_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.rsut_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: : W850 AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='W850';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[-50 50]; p.cs1=[-50 50]; p.cs2=[-3 3];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.w850_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.w850_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: W850: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='W850';p.vname=strcat(vname,'_avg_future_present'); str='-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[-50 50]; p.cs1=[-50 50]; p.cs2=[-3 3];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.w850_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.w850_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: W850: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='W850';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[-100 100]; p.cs1=[-100 100]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.w850_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.w850_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: W850: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='W850';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[-100 100]; p.cs1=[-100 100]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.w850_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.w850_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: : Q850 AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='Q850';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 15]; p.cs1=[0 15]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.q850_av)*1000; p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.q850_av)*1000; p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: Q850: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='Q850';p.vname=strcat(vname,'_avg_future_present'); str='-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 15]; p.cs1=[0 15]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.q850_av)*1000; p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.q850_av)*1000; p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: Q850: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='Q850';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[0 15]; p.cs1=[0 15]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.q850_aravg)*1000; p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.q850_aravg)*1000; p.dtas=4.53;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: Q850: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='Q850';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[0 15]; p.cs1=[0 15]; p.cs2=[-10 10];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.q850_aravg)*1000; p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.q850_aravg)*1000; p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: : T850 AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='T850';p.vname=strcat(vname,'_avg_p4k_climo'); str='-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[250 300]; p.cs1=[250 300]; p.cs2=[-2 2];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.t850_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.t850_av); p.dtas=4.53;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: T850: AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='T850';p.vname=strcat(vname,'_avg_future_present'); str='-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[250 300]; p.cs1=[250 300]; p.cs2=[-2 2];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.t850_av); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.t850_av); p.dtas=0.99;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: T850: AR-AVG P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='T850';p.vname=strcat(vname,'_aravg_p4k_climo'); str='-AR-AVG';
p.s0=strcat('(a) CLIMO-',vname, str);
p.s1=strcat('(b) P4K-'  ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=v1.lm; p.a=v1.aa; p.cs0=[250 300]; p.cs1=[250 300]; p.cs2=[-2 2];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(v1.t850_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(w1.t850_aravg); p.dtas=4.53;
p.dz=(p.z1-p.z0)/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%PE paper: T850: AR-AVG Future minus Present
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='T850';p.vname=strcat(vname,'_aravg_future_present'); str='-AR-AVG';
p.s0=strcat('(a) PRESENT-',vname, str);
p.s1=strcat('(b) FUTURE-' ,vname, str);
p.s2='(c) (b) minus (a)'; p.str='';
p.lm=vm.lm; p.a=v1.aa; p.cs0=[250 300]; p.cs1=[250 300]; p.cs2=[-2 2];
lat0=-10; p.j1=max(find(v1.lat<-lat0)); p.j2=min(find(v1.lat>lat0));
p.z0=squeeze(vm.t850_aravg); p.x1=v1.lon; p.y1=v1.lat;
p.z1=squeeze(wm.t850_aravg); p.dtas=0.99;
p.dz=(p.z1-p.z0)./p.z0*100/p.dtas;
plot_2d_3panel(p); 






%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_PCP P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prw';p.vname=strcat(vname,'_av');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 100]; p.cs1=[0 100]; p.cs2=[-10 10];
p.s0=strcat('(a) P4K-'  ,vname,' (AVG)'); 
p.s1=strcat('(b) CLIMO-',vname,' (AVG)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(w1.prw_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(v1.prw_aravg_p99);
p.dz=(p.z0-p.z1)./p.z1*100/4.52;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_PCP P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[-300 300]; p.cs1=[-300 300]; p.cs2=[-10 10];
p.s0=strcat('(a) P4K-'  ,vname,' (AR-AVG P99)'); 
p.s1=strcat('(b) CLIMO-',vname,' (AR-AVG P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(w1.prday_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(v1.prday_aravg_p99);
p.dz=(p.z0-p.z1)./p.z1*100/4.52;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_PCP P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prw';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 100]; p.cs1=[0 100]; p.cs2=[-10 10];
p.s0=strcat('(a) P4K-'  ,vname,' (AR-AVG P99)'); 
p.s1=strcat('(b) CLIMO-',vname,' (AR-AVG P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(w1.prw_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(v1.prw_aravg_p99);
p.dz=(p.z0-p.z1)./p.z1*100/4.52;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_PCP P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='t850';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[200 300]; p.cs1=[200 300]; p.cs2=[0 2];
p.s0=strcat('(a) P4K-'  ,vname,' (AR-AVG P99)'); 
p.s1=strcat('(b) CLIMO-',vname,' (AR-AVG P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(w1.t850_aravg_p999); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(v1.t850_aravg_p999);
p.dz=(p.z0-p.z1)/4.52;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_PCP P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='tas';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[200 300]; p.cs1=[200 300]; p.cs2=[-1 1];
p.s0=strcat('(a) P4K-'  ,vname,' (AR-AVG P99)'); 
p.s1=strcat('(b) CLIMO-',vname,' (AR-AVG P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(w1.tas_aravg_p999); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(v1.tas_aravg_p999);
p.dz=(p.z0-p.z1)/4.52;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_W850 P4K minus CLIMO
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='w850';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[-400 400]; p.cs1=[-400 400]; p.cs2=[-5 5];
p.s0=strcat('(a) P4K-'  ,vname,' (AR-AVG P99)'); 
p.s1=strcat('(b) CLIMO-',vname,' (AR-AVG P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(w1.w850_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(v1.w850_aravg_p99);
p.dz=(p.z0-p.z1)./p.z1*100/4.52;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig0 AR frequency, fraction of P99 and P999
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
p.vname='arfq_vs_arfqs'; p.str='ANN'; vx=v1; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 0.25]; p.cs1=[0 1]; p.cs2=[0 1];
lat0=30; p.j1=max(find(vx.lat<-lat0)); p.j2=min(find(vx.lat>lat0));
p.s0='(a) frequency of AR days (annual mean)'; 
p.s1='(b) fraction of P>P99 due to ARs'; 
p.s2='(c) fraction of P>P99.9 due to ARs'; p.str=''; k_pct=7;
p.z0=squeeze(vx.arday_fq (1,:,:)); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.prday_fp99_ar)
p.dz=squeeze(vx.prday_fp999_ar)
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_precip
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 100]; p.cs1=[0 100]; p.cs2=[-15 15];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(w1.prday_av); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(v1.prday_av); p.dtas=4.53;
p.dz=(p.z0-p.z1)./p.z1*100/p.dtas;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_precip
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prday';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 100]; p.cs1=[0 100]; p.cs2=[-15 15];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.prday_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.prday_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_precip
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prcday';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 50]; p.cs1=[0 50]; p.cs2=[-2 2];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.prc6hr_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.prc6hr_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig IVTY
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='ivty'; p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');  vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[-500 500]; p.cs1=[-500 500]; p.cs2=[-500 500];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.ivty_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.ivty_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig IVTY
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='ivtx'; p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');  vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[-500 500]; p.cs1=[-500 500]; p.cs2=[-500 500];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.ivtx_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.ivtx_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_PRW
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prw';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 80]; p.cs1=[0 80]; p.cs2=[-10 10];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.prw_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.prw_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_omega850
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prsn';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[-10 10]; p.cs1=[-10 10]; p.cs2=[-10 10];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.prsn_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.prsn_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_omega850
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='w850';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[-800 800]; p.cs1=[-800 800]; p.cs2=[-150 150];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.w850_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.w850_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_omega500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='w500';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[-800 800]; p.cs1=[-800 800]; p.cs2=[-150 150];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.w500_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.w500_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_omega250
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='w250';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[-800 800]; p.cs1=[-800 800]; p.cs2=[-150 150];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.w250_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.w250_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_q850
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='q850';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 15]; p.cs1=[0 15]; p.cs2=[-3 3];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.q850_aravg_p99)*1000; p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.q850_nonar_p99)*1000;
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_q500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='q500';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 5]; p.cs1=[0 5]; p.cs2=[-1 1];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.q500_aravg_p99)*1000; p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.q500_nonar_p99)*1000;
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_q250
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='q250';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 0.5]; p.cs1=[0 0.5]; p.cs2=[-0.1 0.1];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.q250_aravg_p99)*1000; p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.q250_nonar_p99)*1000;
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_t850
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='t850';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[250 300]; p.cs1=[250 300]; p.cs2=[-3 3];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.t850_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.t850_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_t500
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='t500';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[250 270]; p.cs1=[250 270]; p.cs2=[-3 3];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.t500_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.t500_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_t250
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='t250';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[200 240]; p.cs1=[200 240]; p.cs2=[-3 3];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.t250_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.t250_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_ws850
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='ws850';p.vname=strcat(vname,'_aravg_aravgp99_nonarp99');vx=v1;p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 25]; p.cs1=[0 25]; p.cs2=[-10 10];
p.s0=strcat('(a)',vname,' (AR-AVG P99)'); 
p.s1=strcat('(b)',vname,' (Non-AR P99)');
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.ws850_aravg_p99); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.ws850_nonar_p99);
p.dz=p.z0-p.z1;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_WS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='ws850'; p.vname=strcat(vname,'_av_vs_aravg'); p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 30]; p.cs1=[0 30]; p.cs2=[-100 100];
p.s0=strcat('(a)',vname,' (annual mean)'); 
p.s1=strcat('(b)',vname,' (AR average)'); 
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.ws850_av); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.ws850_aravg)
p.dz=(p.z1-p.z0)./p.z0*100;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='ws500'; p.vname=strcat(vname,'_av_vs_aravg'); p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 30]; p.cs1=[0 30]; p.cs2=[-100 100];
p.s0=strcat('(a)',vname,' (annual mean)'); 
p.s1=strcat('(b)',vname,' (AR average)'); 
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.ws500_av); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.ws500_aravg)
p.dz=(p.z1-p.z0)./p.z0*100;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='ws250'; p.vname=strcat(vname,'_av_vs_aravg'); p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 50]; p.cs1=[0 50]; p.cs2=[-150 150];
p.s0=strcat('(a)',vname,' (annual mean)'); 
p.s1=strcat('(b)',vname,' (AR average)'); 
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.ws250_av); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.ws250_aravg)
p.dz=(p.z1-p.z0)./p.z0*100;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_TAS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='tas'; p.vname=strcat(vname,'_av_vs_aravg'); p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[250 300]; p.cs1=[250 300]; p.cs2=[-5 5];
p.s0=strcat('(a)',vname,' (annual mean)'); 
p.s1=strcat('(b)',vname,' (AR average)'); 
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.tas_av); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.tas_aravg)
p.dz=(p.z1-p.z0)./p.z0*100;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='tasmax'; p.vname=strcat(vname,'_av_vs_aravg'); p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[250 300]; p.cs1=[250 300]; p.cs2=[-5 5];
p.s0=strcat('(a)',vname,' (annual mean)'); 
p.s1=strcat('(b)',vname,' (AR average)'); 
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.tasmax_av); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.tasmax_aravg)
p.dz=(p.z1-p.z0)./p.z0*100;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='tasmin'; p.vname=strcat(vname,'_av_vs_aravg'); p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[250 300]; p.cs1=[250 300]; p.cs2=[-5 5];
p.s0=strcat('(a)',vname,' (annual mean)'); 
p.s1=strcat('(b)',vname,' (AR average)'); 
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.tasmin_av); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.tasmin_aravg)
p.dz=(p.z1-p.z0)./p.z0*100;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_HFLS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='hfls'; p.vname=strcat(vname,'_av_vs_aravg'); p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 5]; p.cs1=[0 5]; p.cs2=[-100 100];
p.s0=strcat('(a)',vname,' (annual mean)'); 
p.s1=strcat('(b)',vname,' (AR average)'); 
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.hfls_av); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.hfls_aravg)
p.dz=(p.z1-p.z0)./p.z0*100;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig_PRSN
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
vname='prsn'; p.vname=strcat(vname,'_av_vs_aravg'); p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 3]; p.cs1=[0 3]; p.cs2=[-100 100];
p.s0=strcat('(a)',vname,' (annual mean)'); 
p.s1=strcat('(b)',vname,' (AR average)'); 
p.s2='(c) (b) minus (a)'; p.str='';
p.z0=squeeze(vx.prsn_av); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.prsn_aravg)
p.dz=(p.z1-p.z0)./p.z0*100;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig1
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
p.vname='pcp_pct7_fr_ar'; p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs0=[0 200]; p.cs1=[0 1]; p.cs2=[0 1];
p.s0='(a) Precipitation (99.9 percentile)'; 
p.s1='(b) Precipitation (fraction from AR)'; 
p.s2='(c) (b) minus (a)'; p.str=''; k_pct=6;
p.z0=squeeze(vx.prday_pct  (1,k_pct,:,:)); p.x1=vx.lon; p.y1=vx.lat;
p.z1=squeeze(vx.prday_fr_ar(1,k_pct,:,:))
p.dz=p.z1-p.z0;
plot_2d_3panel(p); 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%CRE paper: Fig1
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
tas0=vx.tas_av_clm.ann; tas1=wm.tas_av_clm.ann; p.dtas=tas1-tas0;
clear p; [p.dtas1,p.dtas2]=get_dtas(vx,wm,v1,w1);
p.vname='Fig13a-c'; p.str='ANN'; 
p.lm=vx.lm; p.a=vx.aa; p.cs1=[-0.01 0.01]; p.cs2=[-0.01 0.01];
p.s1='(a) FUTURE minus PRESENT (absolute)';p.s0=p.s1;
p.s2='(c) P4K minus CLIMO (absolute)';
p.z1=wm.freq_ar_clm.ann-vx.freq_ar_clm.ann; p.x1=wm.lon; p.y1=wm.lat;
p.z2=w1.freq_ar_clm.ann-v1.freq_ar_clm.ann;  
p.z0=vx.freq_ar_clm.ann; p.z3=v1.freq_ar_clm.ann;  
x=vx.ar.leng;  vx.ar_no =length(x)/vx.nyr;
x=wm.ar.leng;  wm.ar_no =length(x)/wm.nyr; (wm.ar_no-vx.ar_no)/vx.ar_no*100/0.99
x=v1.ar.leng;  v1.ar_no =length(x)/v1.nyr;
x=w1.ar.leng;  w1.ar_no =length(x)/w1.nyr; (w1.ar_no-v1.ar_no)/v1.ar_no*100/4.526
x=wm2.ar.leng; wm2.ar_no=length(x)/wm2.nyr;(wm2.ar_no-vx.ar_no)/vx.ar_no*100/0.99
x=w2.ar.leng;  w2.ar_no =length(x)/w2.nyr; (w2.ar_no-v1.ar_no)/v1.ar_no*100/4.526
for i=1:36
  yr0=2015+i-1;
  yr=wm.ar.yyy;  id=(yr==yr0); no1(i)=sum(id);
  yr=wm2.ar.yyy; id=(yr==yr0); no2(i)=sum(id);
end
plot_2d_diff_warm_2(p); 
