%!PS-Adobe-3.0
%%BoundingBox: 38 24 574 768
%%Title: Enscript Output
%%For: Ming Zhao
%%Creator: GNU Enscript 1.6.6
%%CreationDate: Wed Nov 26 13:51:28 2025
%%Orientation: Portrait
%%Pages: (atend)
%%DocumentMedia: Letter 612 792 0 () ()
%%DocumentNeededResources: (atend)
%%EndComments
%%BeginProlog
%%BeginResource: procset Enscript-Prolog 1.6 6
%
% Procedures.
%

/_S {	% save current state
  /_s save def
} def
/_R {	% restore from saved state
  _s restore
} def

/S {	% showpage protecting gstate
  gsave
  showpage
  grestore
} bind def

/MF {	% fontname newfontname -> -	make a new encoded font
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall

  newfont /FontName newfontname put

  % insert only valid encoding vectors
  encoding_vector length 256 eq {
    newfont /Encoding encoding_vector put
  } if

  newfontname newfont definefont pop
} def

/MF_PS { % fontname newfontname -> -	make a new font preserving its enc
  /newfontname exch def
  /fontname exch def

  /fontdict fontname findfont def
  /newfont fontdict maxlength dict def

  fontdict {
    exch
    dup /FID eq {
      % skip FID pair
      pop pop
    } {
      % copy to the new font dictionary
      exch newfont 3 1 roll put
    } ifelse
  } forall

  newfont /FontName newfontname put

  newfontname newfont definefont pop
} def

/SF { % fontname width height -> -	set a new font
  /height exch def
  /width exch def

  findfont
  [width 0 0 height 0 0] makefont setfont
} def

/SUF { % fontname width height -> -	set a new user font
  /height exch def
  /width exch def

  /F-gs-user-font MF
  /F-gs-user-font width height SF
} def

/SUF_PS { % fontname width height -> -	set a new user font preserving its enc
  /height exch def
  /width exch def

  /F-gs-user-font MF_PS
  /F-gs-user-font width height SF
} def

/M {moveto} bind def
/s {show} bind def

/Box {	% x y w h -> -			define box path
  /d_h exch def /d_w exch def /d_y exch def /d_x exch def
  d_x d_y  moveto
  d_w 0 rlineto
  0 d_h rlineto
  d_w neg 0 rlineto
  closepath
} def

/bgs {	% x y height blskip gray str -> -	show string with bg color
  /str exch def
  /gray exch def
  /blskip exch def
  /height exch def
  /y exch def
  /x exch def

  gsave
    x y blskip sub str stringwidth pop height Box
    gray setgray
    fill
  grestore
  x y M str s
} def

/bgcs { % x y height blskip red green blue str -> -  show string with bg color
  /str exch def
  /blue exch def
  /green exch def
  /red exch def
  /blskip exch def
  /height exch def
  /y exch def
  /x exch def

  gsave
    x y blskip sub str stringwidth pop height Box
    red green blue setrgbcolor
    fill
  grestore
  x y M str s
} def

% Highlight bars.
/highlight_bars {	% nlines lineheight output_y_margin gray -> -
  gsave
    setgray
    /ymarg exch def
    /lineheight exch def
    /nlines exch def

    % This 2 is just a magic number to sync highlight lines to text.
    0 d_header_y ymarg sub 2 sub translate

    /cw d_output_w cols div def
    /nrows d_output_h ymarg 2 mul sub lineheight div cvi def

    % for each column
    0 1 cols 1 sub {
      cw mul /xp exch def

      % for each rows
      0 1 nrows 1 sub {
        /rn exch def
        rn lineheight mul neg /yp exch def
        rn nlines idiv 2 mod 0 eq {
	  % Draw highlight bar.  4 is just a magic indentation.
	  xp 4 add yp cw 8 sub lineheight neg Box fill
	} if
      } for
    } for

  grestore
} def

% Line highlight bar.
/line_highlight {	% x y width height gray -> -
  gsave
    /gray exch def
    Box gray setgray fill
  grestore
} def

% Column separator lines.
/column_lines {
  gsave
    .1 setlinewidth
    0 d_footer_h translate
    /cw d_output_w cols div def
    1 1 cols 1 sub {
      cw mul 0 moveto
      0 d_output_h rlineto stroke
    } for
  grestore
} def

% Column borders.
/column_borders {
  gsave
    .1 setlinewidth
    0 d_footer_h moveto
    0 d_output_h rlineto
    d_output_w 0 rlineto
    0 d_output_h neg rlineto
    closepath stroke
  grestore
} def

% Do the actual underlay drawing
/draw_underlay {
  ul_style 0 eq {
    ul_str true charpath stroke
  } {
    ul_str show
  } ifelse
} def

% Underlay
/underlay {	% - -> -
  gsave
    0 d_page_h translate
    d_page_h neg d_page_w atan rotate

    ul_gray setgray
    ul_font setfont
    /dw d_page_h dup mul d_page_w dup mul add sqrt def
    ul_str stringwidth pop dw exch sub 2 div ul_h_ptsize -2 div moveto
    draw_underlay
  grestore
} def

/user_underlay {	% - -> -
  gsave
    ul_x ul_y translate
    ul_angle rotate
    ul_gray setgray
    ul_font setfont
    0 0 ul_h_ptsize 2 div sub moveto
    draw_underlay
  grestore
} def

% Page prefeed
/page_prefeed {		% bool -> -
  statusdict /prefeed known {
    statusdict exch /prefeed exch put
  } {
    pop
  } ifelse
} def

% Wrapped line markers
/wrapped_line_mark {	% x y charwith charheight type -> -
  /type exch def
  /h exch def
  /w exch def
  /y exch def
  /x exch def

  type 2 eq {
    % Black boxes (like TeX does)
    gsave
      0 setlinewidth
      x w 4 div add y M
      0 h rlineto w 2 div 0 rlineto 0 h neg rlineto
      closepath fill
    grestore
  } {
    type 3 eq {
      % Small arrows
      gsave
        .2 setlinewidth
        x w 2 div add y h 2 div add M
        w 4 div 0 rlineto
        x w 4 div add y lineto stroke

        x w 4 div add w 8 div add y h 4 div add M
        x w 4 div add y lineto
	w 4 div h 8 div rlineto stroke
      grestore
    } {
      % do nothing
    } ifelse
  } ifelse
} def

% EPSF import.

/BeginEPSF {
  /b4_Inc_state save def    		% Save state for cleanup
  /dict_count countdictstack def	% Count objects on dict stack
  /op_count count 1 sub def		% Count objects on operand stack
  userdict begin
  /showpage { } def
  0 setgray 0 setlinecap
  1 setlinewidth 0 setlinejoin
  10 setmiterlimit [ ] 0 setdash newpath
  /languagelevel where {
    pop languagelevel
    1 ne {
      false setstrokeadjust false setoverprint
    } if
  } if
} bind def

/EndEPSF {
  count op_count sub { pos } repeat	% Clean up stacks
  countdictstack dict_count sub { end } repeat
  b4_Inc_state restore
} bind def

% Check PostScript language level.
/languagelevel where {
  pop /gs_languagelevel languagelevel def
} {
  /gs_languagelevel 1 def
} ifelse
%%EndResource
%%BeginResource: procset Enscript-Encoding-88591 1.6 6
/encoding_vector [
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclam       	/quotedbl     	/numbersign   	
/dollar       	/percent      	/ampersand    	/quoteright   	
/parenleft    	/parenright   	/asterisk     	/plus         	
/comma        	/hyphen       	/period       	/slash        	
/zero         	/one          	/two          	/three        	
/four         	/five         	/six          	/seven        	
/eight        	/nine         	/colon        	/semicolon    	
/less         	/equal        	/greater      	/question     	
/at           	/A            	/B            	/C            	
/D            	/E            	/F            	/G            	
/H            	/I            	/J            	/K            	
/L            	/M            	/N            	/O            	
/P            	/Q            	/R            	/S            	
/T            	/U            	/V            	/W            	
/X            	/Y            	/Z            	/bracketleft  	
/backslash    	/bracketright 	/asciicircum  	/underscore   	
/quoteleft    	/a            	/b            	/c            	
/d            	/e            	/f            	/g            	
/h            	/i            	/j            	/k            	
/l            	/m            	/n            	/o            	
/p            	/q            	/r            	/s            	
/t            	/u            	/v            	/w            	
/x            	/y            	/z            	/braceleft    	
/bar          	/braceright   	/tilde        	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/.notdef      	/.notdef      	/.notdef      	/.notdef      	
/space        	/exclamdown   	/cent         	/sterling     	
/currency     	/yen          	/brokenbar    	/section      	
/dieresis     	/copyright    	/ordfeminine  	/guillemotleft	
/logicalnot   	/hyphen       	/registered   	/macron       	
/degree       	/plusminus    	/twosuperior  	/threesuperior	
/acute        	/mu           	/paragraph    	/bullet       	
/cedilla      	/onesuperior  	/ordmasculine 	/guillemotright	
/onequarter   	/onehalf      	/threequarters	/questiondown 	
/Agrave       	/Aacute       	/Acircumflex  	/Atilde       	
/Adieresis    	/Aring        	/AE           	/Ccedilla     	
/Egrave       	/Eacute       	/Ecircumflex  	/Edieresis    	
/Igrave       	/Iacute       	/Icircumflex  	/Idieresis    	
/Eth          	/Ntilde       	/Ograve       	/Oacute       	
/Ocircumflex  	/Otilde       	/Odieresis    	/multiply     	
/Oslash       	/Ugrave       	/Uacute       	/Ucircumflex  	
/Udieresis    	/Yacute       	/Thorn        	/germandbls   	
/agrave       	/aacute       	/acircumflex  	/atilde       	
/adieresis    	/aring        	/ae           	/ccedilla     	
/egrave       	/eacute       	/ecircumflex  	/edieresis    	
/igrave       	/iacute       	/icircumflex  	/idieresis    	
/eth          	/ntilde       	/ograve       	/oacute       	
/ocircumflex  	/otilde       	/odieresis    	/divide       	
/oslash       	/ugrave       	/uacute       	/ucircumflex  	
/udieresis    	/yacute       	/thorn        	/ydieresis    	
] def
%%EndResource
%%EndProlog
%%BeginSetup
%%IncludeResource: font Courier-Bold
%%IncludeResource: font Courier
/HFpt_w 10 def
/HFpt_h 10 def
/Courier-Bold /HF-gs-font MF
/HF /HF-gs-font findfont [HFpt_w 0 0 HFpt_h 0 0] makefont def
/Courier /F-gs-font MF
/F-gs-font 10 10 SF
/#copies 1 def
% Pagedevice definitions:
gs_languagelevel 1 gt {
  <<
    /PageSize [612 792] 
  >> setpagedevice
} if
%%BeginResource: procset Enscript-Header-simple 1.6 6

/do_header {	% print default simple header
  gsave
    d_header_x d_header_y HFpt_h 3 div add translate

    HF setfont
    user_header_p {
      5 0 moveto user_header_left_str show

      d_header_w user_header_center_str stringwidth pop sub 2 div
      0 moveto user_header_center_str show

      d_header_w user_header_right_str stringwidth pop sub 5 sub
      0 moveto user_header_right_str show
    } {
      fname length fmodstr length add pagenumstr length add 95 6 idiv add d_header_w 6 idiv le{
        5 0 moveto fname show
        45 0 rmoveto fmodstr show
        45 0 rmoveto pagenumstr show
      } {
        5 0 moveto fmodstr show
        45 0 rmoveto pagenumstr show
        fname length d_header_w 6 idiv idiv 1 add 10 mul 5 exch moveto
        1 1 fname length d_header_w 6 idiv idiv
        {
          dup fname exch 1 sub d_header_w 6 idiv mul d_header_w 6 idiv getinterval show
          5 exch 10 mul fname length d_header_w 6 idiv idiv 1 add 10 mul exch sub moveto
        } for
        5 10 moveto
        fname fname length d_header_w 6 idiv idiv d_header_w 6 idiv mul dup fname length exch sub getinterval show
      }ifelse
    }ifelse

  grestore
} def
%%EndResource
/d_page_w 536 def
/d_page_h 744 def
/d_header_x 0 def
/d_header_y 700 def
/d_header_w 536 def
/d_header_h 44 def
/d_footer_x 0 def
/d_footer_y 0 def
/d_footer_w 536 def
/d_footer_h 0 def
/d_output_w 536 def
/d_output_h 700 def
/cols 1 def
%%EndSetup
%%Page: (1) 1
%%BeginPageSetup
_S
38 24 translate
/pagenum 1 def
/fname (fwi1D.m) def
/fdir (.) def
/ftail (fwi1D.m) def
% User defined strings:
/fmodstr (Wed Nov 26 13:48:58 2025) def
/pagenumstr (1) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
do_header
5 687 M
(function out = fwi1D\(months, Tm, H, r, W, lat, what, init_pars, spin_up\)) s
5 676 M
(%FWI1D Canadian Fire Weather Index for 1-D Time Series) s
5 665 M
(%) s
5 654 M
(%   out = FWI1D\(months, Tm, H, r, W\)) s
5 643 M
(%   computes the Fire Weather Index \(FWI\) system using daily meteorological) s
5 632 M
(%   inputs. By default, only the FWI component is returned.) s
5 621 M
(%) s
5 610 M
(%   out = FWI1D\(months, Tm, H, r, W, lat, what, init_pars, spin_up\)) s
5 599 M
(%) s
5 588 M
(%   INPUTS) s
5 577 M
(%       months      : Nx1 integer vector \(1\342\\200\\22312\), month of each record) s
5 566 M
(%       Tm          : Nx1 vector, temperature \(\302\260C\)) s
5 555 M
(%       H           : Nx1 vector, relative humidity \(%\)) s
5 544 M
(%       r           : Nx1 vector, 24-hr precipitation \(mm\)) s
5 533 M
(%       W           : Nx1 vector, wind speed \(km/h\)) s
5 522 M
(%) s
5 511 M
(%   OPTIONAL INPUTS) s
5 500 M
(%       lat         : Latitude in degrees \(default = 46\)) s
5 489 M
(%       what        : Components to return. Any subset of:) s
5 478 M
(%                       {"FFMC","DMC","DC","ISI","BUI","FWI","DSR"}) s
5 467 M
(%                     default = "FWI") s
5 456 M
(%       init_pars   : 1x3 vector of initial [FFMC DMC DC] values) s
5 445 M
(%                     default = [85 6 15]) s
5 434 M
(%       spin_up     : Integer number of leading days set to NaN) s
5 423 M
(%                     default = 0) s
5 412 M
(%) s
5 401 M
(%   OUTPUT) s
5 390 M
(%       out         : NxK numeric matrix) s
5 379 M
(%                     rows   = time \(days\)) s
5 368 M
(%                     cols   = requested components \(in order of "what"\)) s
5 357 M
(%) s
5 346 M
(%   REFERENCES) s
5 335 M
(%       Van Wagner \(1987\), Lawson & Armitage \(2008\),) s
5 324 M
(%       Van Wagner & Pickett \(1985\)) s
5 313 M
(%) s
5 302 M
(%   AUTHOR) s
5 291 M
(%       MATLAB translation based on J. Bedia's R implementation) s
5 280 M
(%) s
5 269 M
(%references) s
5 258 M
(%Lawson, B.D. & Armitage, O.B., 2008.) s
5 247 M
(%Weather guide for the Canadian Forest Fire Danger Rating System. Northern Forestry Cen) s
5 236 M
(tre, Edmonton \(Canada\).) s
5 225 M
(%van Wagner, C.E., 1987.) s
5 214 M
(%Development and structure of the Canadian Forest Fire Weather Index \(Forestry Tech. Re) s
5 203 M
(p. No. 35\). Canadian Forestry Service, Ottawa, Canada.) s
5 192 M
(%van Wagner, C.E., Pickett, T.L., 1985.) s
5 181 M
(%Equations and FORTRAN program for the Canadian forest fire weather index system \(Fores) s
5 170 M
(try Tech. Rep. No. 33\). Canadian Forestry Service, Ottawa, Canada.) s
5 159 M
(%author J. Bedia, partially based on the original FORTRAN code by van Wagner and Picket) s
5 148 M
(t \(1985\)) s
5 137 M
(% ---------------------- INPUT VALIDATION -------------------------------) s
5 115 M
(% Check required inputs) s
5 104 M
(if nargin < 5) s
5 93 M
(    error\('At least five inputs \(months, Tm, H, r, W\) are required.'\);) s
5 82 M
(end) s
5 60 M
(% Validate vector shapes) s
5 49 M
(inputs = {months, Tm, H, r, W};) s
5 38 M
(names  = {'months','Tm','H','r','W'};) s
5 27 M
(n = length\(months\);) s
5 5 M
(for k = 1:5) s
_R
S
%%Page: (2) 2
%%BeginPageSetup
_S
38 24 translate
/pagenum 2 def
/fname (fwi1D.m) def
/fdir (.) def
/ftail (fwi1D.m) def
% User defined strings:
/fmodstr (Wed Nov 26 13:48:58 2025) def
/pagenumstr (2) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
do_header
5 687 M
(    if ~isvector\(inputs{k}\)) s
5 676 M
(        error\('Input "%s" must be a vector.', names{k}\);) s
5 665 M
(    end) s
5 654 M
(    if length\(inputs{k}\) ~= n) s
5 643 M
(        error\('All input vectors must have the same length.'\);) s
5 632 M
(    end) s
5 621 M
(end) s
5 599 M
(% Set defaults) s
5 588 M
(if nargin < 6 || isempty\(lat\),       lat = 46;      end) s
5 577 M
(if nargin < 7 || isempty\(what\),      what = "FWI";  end) s
5 566 M
(if nargin < 8 || isempty\(init_pars\), init_pars = [85 6 15]; end) s
5 555 M
(if nargin < 9 || isempty\(spin_up\),   spin_up = 0;   end) s
5 533 M
(% Validate latitude) s
5 522 M
(if ~isscalar\(lat\) || ~isnumeric\(lat\) || lat < -90 || lat > 90) s
5 511 M
(    error\('Latitude must be a numeric scalar in [-90, 90].'\);) s
5 500 M
(end) s
5 478 M
(% Validate init_pars) s
5 467 M
(if ~isnumeric\(init_pars\) || length\(init_pars\) ~= 3) s
5 456 M
(    error\('"init_pars" must be a numeric vector of length 3.'\);) s
5 445 M
(end) s
5 423 M
(% Validate spin_up) s
5 412 M
(if ~isscalar\(spin_up\) || spin_up < 0 || mod\(spin_up,1\) ~= 0) s
5 401 M
(    error\('"spin_up" must be a non-negative integer.'\);) s
5 390 M
(end) s
5 368 M
(% Validate "what") s
5 357 M
(validChoices = ["FFMC","DMC","DC","ISI","BUI","FWI","DSR"];) s
5 346 M
(what = string\(what\);) s
5 335 M
(if ~all\(ismember\(what, validChoices\)\)) s
5 324 M
(    error\('"what" contains invalid component names.'\);) s
5 313 M
(end) s
5 291 M
(%% ---------------------- MISSING DATA HANDLING --------------------------) s
5 269 M
(isGood = isfinite\(Tm\) & isfinite\(H\) & isfinite\(r\) & isfinite\(W\);) s
5 258 M
(if ~all\(isGood\)) s
5 247 M
(    warning\('Missing values detected. These records will be removed.'\);) s
5 236 M
(    months = months\(isGood\);) s
5 225 M
(    Tm     = Tm\(isGood\);) s
5 214 M
(    H      = H\(isGood\);) s
5 203 M
(    r      = r\(isGood\);) s
5 192 M
(    W      = W\(isGood\);) s
5 181 M
(end) s
5 159 M
(n2  = length\(months\);) s
5 148 M
(out = NaN\(n, length\(what\)\); % final output \(full length\)) s
5 126 M
(%% ---------------------- PHYSICAL CORRECTION ----------------------------) s
5 104 M
(H\(H > 100\) = 100;) s
5 93 M
(H\(H <   0\) = 0;) s
5 82 M
(r\(r <   0\) = 0;) s
5 71 M
(W\(W <   0\) = 0;) s
5 49 M
(%% ---------------------- LATITUDE FACTORS -------------------------------) s
5 27 M
(ref_lats = [-90 -30 -10 10 30 90];) s
5 16 M
(loc = findInterval\(lat, ref_lats\);) s
_R
S
%%Page: (3) 3
%%BeginPageSetup
_S
38 24 translate
/pagenum 3 def
/fname (fwi1D.m) def
/fdir (.) def
/ftail (fwi1D.m) def
% User defined strings:
/fmodstr (Wed Nov 26 13:48:58 2025) def
/pagenumstr (3) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
do_header
5 687 M
(switch loc) s
5 676 M
(    case 1) s
5 665 M
(        Le  = [11.5 10.5 9.2 7.9 6.8 6.2 6.5 7.4 8.7 10.0 11.2 11.8];) s
5 654 M
(        dlf = [6.4 5.0 2.4 0.4 -1.6 -1.6 -1.6 -1.6 -1.6 0.9 3.8 5.8];) s
5 643 M
(    case 2) s
5 632 M
(        Le  = [10.1 9.6 9.1 8.5 8.1 7.8 7.9 8.3 8.9 9.4 9.9 10.2];) s
5 621 M
(        dlf = [6.4 5.0 2.4 0.4 -1.6 -1.6 -1.6 -1.6 -1.6 0.9 3.8 5.8];) s
5 610 M
(    case 3) s
5 599 M
(        Le  = repmat\(9,1,12\);) s
5 588 M
(        dlf = repmat\(1.4,1,12\);) s
5 577 M
(    case 4) s
5 566 M
(        Le  = [7.9 8.4 8.9 9.5 9.9 10.2 10.1 9.7 9.1 8.6 8.1 7.8];) s
5 555 M
(        dlf = [-1.6 -1.6 -1.6 0.9 3.8 5.8 6.4 5.0 2.4 0.4 -1.6 -1.6];) s
5 544 M
(    case 5) s
5 533 M
(        Le  = [6.5 7.5 9.0 12.8 13.9 13.9 12.4 10.9 9.4 8.0 7.0 6.0];) s
5 522 M
(        dlf = [-1.6 -1.6 -1.6 0.9 3.8 5.8 6.4 5.0 2.4 0.4 -1.6 -1.6];) s
5 511 M
(    otherwise) s
5 500 M
(        error\('Latitude out of bounds.'\);) s
5 489 M
(end) s
5 467 M
(    % Defaults) s
5 456 M
(    if nargin < 6 || isempty\(lat\), lat = 46; end) s
5 445 M
(    if nargin < 7 || isempty\(what\), what = "FWI"; end) s
5 434 M
(    if nargin < 8 || isempty\(init_pars\), init_pars = [85, 6, 15]; end) s
5 423 M
(    if nargin < 9 || isempty\(spin_up\), spin_up = 0; end) s
5 401 M
(    % Check vector lengths) s
5 390 M
(    n = length\(months\);) s
5 379 M
(    if any\([length\(Tm\), length\(H\), length\(r\), length\(W\)] ~= n\)) s
5 368 M
(        error\('Input vector lengths differ'\);) s
5 357 M
(    end) s
5 335 M
(    % Allowed components) s
5 324 M
(    choices = ["FFMC","DMC","DC","ISI","BUI","FWI","DSR"];) s
5 313 M
(    if ischar\(what\) || isstring\(what\)) s
5 302 M
(        what = string\(what\);) s
5 291 M
(    end) s
5 280 M
(    if ~all\(ismember\(what,choices\)\)) s
5 269 M
(        error\('Invalid entry in "what" argument'\);) s
5 258 M
(    end) s
5 236 M
(    % Initialize output) s
5 225 M
(    out = NaN\(n, length\(what\)\);) s
5 214 M
(    colnames = what;) s
5 203 M
(    ) s
5 192 M
(    % Remove missing values) s
5 181 M
(    rm_ind = find\(~\(isfinite\(Tm\) & isfinite\(H\) & isfinite\(r\) & isfinite\(W\)\)\);) s
5 170 M
(    non_na_ind = setdiff\(1:n, rm_ind\);) s
5 148 M
(    if ~isempty\(rm_ind\)) s
5 137 M
(        warning\('Missing values were removed from the time series before computation'\);) s
5 126 M
(        months\(rm_ind\) = [];) s
5 115 M
(        Tm\(rm_ind\) = [];) s
5 104 M
(        H\(rm_ind\) = [];) s
5 93 M
(        r\(rm_ind\) = [];) s
5 82 M
(        W\(rm_ind\) = [];) s
5 71 M
(    end) s
5 49 M
(    mes = months;) s
5 38 M
(    n2 = length\(mes\);) s
5 16 M
(    % Latitude tables \(Lawson & Armitage\)) s
5 5 M
(    ref_lats = [-90 -30 -10 10 30 90];) s
_R
S
%%Page: (4) 4
%%BeginPageSetup
_S
38 24 translate
/pagenum 4 def
/fname (fwi1D.m) def
/fdir (.) def
/ftail (fwi1D.m) def
% User defined strings:
/fmodstr (Wed Nov 26 13:48:58 2025) def
/pagenumstr (4) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
do_header
5 687 M
(    loc = findInterval\(lat, ref_lats\);) s
5 665 M
(    switch loc) s
5 654 M
(        case 1) s
5 643 M
(            Le  = [11.5 10.5 9.2 7.9 6.8 6.2 6.5 7.4 8.7 10.0 11.2 11.8];) s
5 632 M
(            dlf = [6.4 5.0 2.4 0.4 -1.6 -1.6 -1.6 -1.6 -1.6 0.9 3.8 5.8];) s
5 621 M
(        case 2) s
5 610 M
(            Le  = [10.1 9.6 9.1 8.5 8.1 7.8 7.9 8.3 8.9 9.4 9.9 10.2];) s
5 599 M
(            dlf = [6.4 5.0 2.4 0.4 -1.6 -1.6 -1.6 -1.6 -1.6 0.9 3.8 5.8];) s
5 588 M
(        case 3) s
5 577 M
(            Le  = repmat\(9,1,12\);) s
5 566 M
(            dlf = repmat\(1.4,1,12\);) s
5 555 M
(        case 4) s
5 544 M
(            Le  = [7.9 8.4 8.9 9.5 9.9 10.2 10.1 9.7 9.1 8.6 8.1 7.8];) s
5 533 M
(            dlf = [-1.6 -1.6 -1.6 0.9 3.8 5.8 6.4 5.0 2.4 0.4 -1.6 -1.6];) s
5 522 M
(        case 5) s
5 511 M
(            Le  = [6.5 7.5 9.0 12.8 13.9 13.9 12.4 10.9 9.4 8.0 7.0 6.0];) s
5 500 M
(            dlf = [-1.6 -1.6 -1.6 0.9 3.8 5.8 6.4 5.0 2.4 0.4 -1.6 -1.6];) s
5 489 M
(        otherwise) s
5 478 M
(            error\('Latitude out of bounds'\);) s
5 467 M
(    end) s
5 445 M
(    % Corrections) s
5 434 M
(    H\(H > 100\) = 100;) s
5 423 M
(    H\(H < 0\) = 0;) s
5 412 M
(    r\(r < 0\) = 0;) s
5 401 M
(    W\(W < 0\) = 0;) s
5 379 M
(    % Initialization) s
5 368 M
(    f0  = [init_pars\(1\) NaN\(1,n2\)];) s
5 357 M
(    p0  = [init_pars\(2\) NaN\(1,n2\)];) s
5 346 M
(    d0  = [init_pars\(3\) NaN\(1,n2\)];) s
5 324 M
(    ISI = NaN\(1,n2\);) s
5 313 M
(    BUI = NaN\(1,n2\);) s
5 302 M
(    FWI = NaN\(1,n2\);) s
5 280 M
(    % MAIN LOOP) s
5 269 M
(    for i = 1:n2) s
5 247 M
(        % ----- FFMC \(Fine Fuel Moisture Code\) Moisture Model -----) s
5 236 M
(%f0 is FFMC, m0 is fuel moisture content;) s
5 225 M
(%High FFMC \(e.g., 90-100\): Corresponds to very low moisture content \(M\342\\211\\2102\342\\210) s
5 214 M
(\\2227%\).) s
5 203 M
(%Physically, this means the fuels are nearly "oven dry.") s
5 192 M
(%Low FFMC \(e.g., below 80\): Corresponds to high moisture content \(M>10%\).) s
5 181 M
(%Physically, the fuels are damp and resist combustion.) s
5 170 M
(%The FFMC has a short time lag \(memory\) of about one day because fine fuels) s
5 159 M
(%quickly respond to changes in temperature, relative humidity, and wind.) s
5 148 M
(%Physical Process: Unlike the Drought Code \(DC\), which tracks deep soil moisture) s
5 137 M
(%over weeks, the FFMC tracks surface fuels that can dry out rapidly in just a few) s
5 126 M
(%hours of sunshine and low humidity, or become damp again overnight.) s
5 115 M
(%Daily Interpretation: The FFMC value calculated for today reflects the cumulative) s
5 104 M
(%effect of the last 24 hours of weather on the top layer of fuel.     ) s
5 93 M
(        m0 = \(147.2 * \(101 - f0\(i\)\)\) / \(59.5 + f0\(i\)\); %m0:moisture content) s
5 71 M
(        if r\(i\) > 0.5) s
5 60 M
(            rA = r\(i\) - 0.5;) s
5 49 M
(            if m0 <= 150) s
5 38 M
(                mr = m0 + 42.5 * rA * exp\(-100/\(251 - m0\)\) * \(1 - exp\(-6.93/rA\)\);) s
5 27 M
(            else) s
5 16 M
(                mr = m0 + 42.5 * rA * exp\(-100/\(251 - m0\)\) * \(1 - exp\(-6.93/rA\)\) + \(0.0) s
5 5 M
(015 * \(m0 - 150\)^2 * sqrt\(rA\)\);) s
_R
S
%%Page: (5) 5
%%BeginPageSetup
_S
38 24 translate
/pagenum 5 def
/fname (fwi1D.m) def
/fdir (.) def
/ftail (fwi1D.m) def
% User defined strings:
/fmodstr (Wed Nov 26 13:48:58 2025) def
/pagenumstr (5) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
do_header
5 687 M
(            end) s
5 676 M
(            mr = min\(mr,250\);) s
5 665 M
(            m0 = mr;) s
5 654 M
(        end) s
5 632 M
(% The Role of Equilibrium Moisture Content \(E\)) s
5 621 M
(% In the FFMC calculation, there are actually two separate calculated values for E Ewet) s
5 610 M
( and E_dry) s
5 599 M
(% E_wet \(Wetting Equilibrium\): This is the higher moisture content limit the fuel will ) s
5 588 M
(reach under wetting conditions \(high H\)) s
5 577 M
(% E_dry \(Drying  Equilibrium\): This is the lower  moisture content limit the fuel will ) s
5 566 M
(reach under drying conditions  \(low H\)) s
5 555 M
(% This distinction is based on the phenomenon of hysteresis, which means that fuels do ) s
5 544 M
(not absorb and release moisture at) s
5 533 M
(% exactly the same rate or equilibrium point.) s
5 522 M
(% Determining the Condition:The FFMC calculation determines the condition by comparing ) s
5 511 M
(the current fuel moisture \(m0\)) s
5 500 M
(% against these two calculated equilibrium points: E_dry > E_wet) s
5 489 M
(% Drying  m0 > E_dry FFMC decrease towards this larger value \(E_dry\)) s
5 478 M
(% Wetting m0 < E_wet FFMC increase towards this smaller value \(E_wet\)) s
5 467 M
(% Neutral E_dry <= m0 <= E_wet FFMC remains mostly unchanged \(very slow change\)) s
5 445 M
(        Ed = 0.942*H\(i\)^0.679 + 11*exp\(\(H\(i\)-100\)/10\) + 0.18*\(21.1-Tm\(i\)\)*\(1 - exp\(-0.1) s
5 434 M
(15*H\(i\)\)\);) s
5 423 M
(        Ew = 0.618*H\(i\)^0.753 + 10*exp\(\(H\(i\)-100\)/10\) + 0.18*\(21.1-Tm\(i\)\)*\(1 - exp\(-0.1) s
5 412 M
(15*H\(i\)\)\);) s
5 390 M
(        if m0 > Ed) s
5 379 M
(            k0 = 0.424*\(1 - \(H\(i\)/100\)^1.7\) + 0.0694*sqrt\(W\(i\)\)*\(1 - \(H\(i\)/100\)^8\);) s
5 368 M
(            kd = k0 * 0.581 * exp\(0.0365*Tm\(i\)\);) s
5 357 M
(            m  = Ed + \(m0 - Ed\) * 10^\(-kd\);) s
5 346 M
(        elseif m0 < Ew) s
5 335 M
(            k1 = 0.424*\(1 - \(\(100-H\(i\)\)/100\)^1.7\) + 0.0694*sqrt\(W\(i\)\)*\(1 - \(\(100-H\(i\)\)/) s
5 324 M
(100\)^8\);) s
5 313 M
(            kw = k1 * 0.581 * exp\(0.0365*Tm\(i\)\);) s
5 302 M
(            m  = Ew - \(Ew - m0\) * 10^\(-kw\);) s
5 291 M
(        else) s
5 280 M
(            m = m0;) s
5 269 M
(        end) s
5 247 M
(        m = max\(m,0\);) s
5 236 M
(        f0\(i+1\) = 59.5*\(250 - m\) / \(147.2 + m\); %change from moisture content to FFMC) s
5 214 M
(        % ----- DMC & DC -----) s
5 203 M
(        Ti = max\(Tm\(i\), -1.1\);) s
5 192 M
(        K = 1.894 * \(Ti + 1.1\) * \(100 - H\(i\)\) * Le\(mes\(i\)\) * 1e-06;) s
5 170 M
(        if r\(i\) > 1.5) s
5 159 M
(            re = 0.92*r\(i\) - 1.27;) s
5 148 M
(            M0 = 20 + exp\(5.6348 - p0\(i\)/43.43\);) s
5 126 M
(            if p0\(i\) <= 33) s
5 115 M
(                b = 100 / \(0.5 + 0.3*p0\(i\)\);) s
5 104 M
(            elseif p0\(i\) > 65) s
5 93 M
(                b = 6.2*log\(p0\(i\)\) - 17.2;) s
5 82 M
(            else) s
5 71 M
(                b = 14 - 1.3*log\(p0\(i\)\);) s
5 60 M
(            end) s
5 38 M
(            Mr = M0 + \(1000*re\)/\(48.77 + b*re\);) s
5 27 M
(            pr = 244.72 - 43.43*log\(Mr - 20\);) s
5 16 M
(            pr = max\(pr,0\);) s
5 5 M
(            p0\(i+1\) = pr + 100*K;) s
_R
S
%%Page: (6) 6
%%BeginPageSetup
_S
38 24 translate
/pagenum 6 def
/fname (fwi1D.m) def
/fdir (.) def
/ftail (fwi1D.m) def
% User defined strings:
/fmodstr (Wed Nov 26 13:48:58 2025) def
/pagenumstr (6) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
do_header
5 687 M
(        else) s
5 676 M
(            p0\(i+1\) = p0\(i\) + 100*K;) s
5 665 M
(        end) s
5 643 M
(        Ti2 = max\(Tm\(i\), -2.8\);) s
5 632 M
(        v = 0.36*\(Ti2 + 2.8\) + dlf\(mes\(i\)\);) s
5 621 M
(        v = max\(v,0\);) s
5 599 M
(        if r\(i\) > 2.8) s
5 588 M
(            rd = 0.83*r\(i\) - 1.27;) s
5 577 M
(            q0 = 800*exp\(-d0\(i\)/400\);) s
5 566 M
(            qr = q0 + 3.937*rd;) s
5 555 M
(            dr = 400*log\(800/qr\);) s
5 544 M
(            dr = max\(dr,0\);) s
5 533 M
(            d0\(i+1\) = dr + 0.5*v;) s
5 522 M
(        else) s
5 511 M
(            d0\(i+1\) = d0\(i\) + 0.5*v;) s
5 500 M
(        end) s
5 478 M
(        % ----- ISI -----) s
5 467 M
(        fW = exp\(0.05039*W\(i\)\);) s
5 456 M
(        fF = 91.9*exp\(-0.1386*m\)*\(1 + \(m^5.31\)/\(4.93e7\)\);) s
5 445 M
(        ISI\(i\) = 0.208 * fW * fF;) s
5 423 M
(        % ----- BUI -----) s
5 412 M
(        if p0\(i+1\) <= 0.4 * d0\(i+1\)) s
5 401 M
(            BUI\(i\) = \(0.8*p0\(i+1\)*d0\(i+1\)\) / \(p0\(i+1\) + 0.4*d0\(i+1\)\);) s
5 390 M
(        else) s
5 379 M
(            BUI\(i\) = p0\(i+1\) - \(1 - \(0.8*d0\(i+1\)\)/\(p0\(i+1\) + 0.4*d0\(i+1\)\)\) * ...) s
5 368 M
(                     \(0.92 + \(0.0114*p0\(i+1\)\)^1.7\);) s
5 357 M
(        end) s
5 335 M
(        if ~isfinite\(BUI\(i\)\) || BUI\(i\) < 0) s
5 324 M
(            BUI\(i\) = 0;) s
5 313 M
(        end) s
5 291 M
(        % ----- FWI -----) s
5 280 M
(        if BUI\(i\) > 80) s
5 269 M
(            fD = 1000/\(25 + 108.64*exp\(-0.023*BUI\(i\)\)\);) s
5 258 M
(        else) s
5 247 M
(            fD = 0.626*BUI\(i\)^0.809 + 2;) s
5 236 M
(        end) s
5 214 M
(        B = 0.1 * ISI\(i\) * fD;) s
5 192 M
(        if B > 1) s
5 181 M
(            Slog = 2.72*\(0.434*log\(B\)\)^0.647;) s
5 170 M
(            FWI\(i\) = exp\(Slog\);) s
5 159 M
(        else) s
5 148 M
(            FWI\(i\) = B;) s
5 137 M
(        end) s
5 126 M
(    end) s
5 104 M
(    % Final components) s
5 93 M
(    FFMC = f0\(2:end\);) s
5 82 M
(    DMC  = p0\(2:end\);) s
5 71 M
(    DC   = d0\(2:end\);) s
5 60 M
(    DSR  = 0.0272 * FWI.^1.77;) s
5 27 M
(% Assemble output from selected components) s
5 16 M
(vars = struct\('FFMC',FFMC,'DMC',DMC,'DC',DC,'ISI',ISI,'BUI',BUI,'FWI',FWI,'DSR',DSR\);) s
5 5 M
(temp = zeros\(n2, length\(what\)\);) s
_R
S
%%Page: (7) 7
%%BeginPageSetup
_S
38 24 translate
/pagenum 7 def
/fname (fwi1D.m) def
/fdir (.) def
/ftail (fwi1D.m) def
% User defined strings:
/fmodstr (Wed Nov 26 13:48:58 2025) def
/pagenumstr (7) def
/user_header_p false def
/user_footer_p false def
%%EndPageSetup
do_header
5 687 M
(for k = 1:length\(what\)) s
5 676 M
(    temp\(:,k\) = vars.\(what\(k\)\);) s
5 665 M
(end) s
5 643 M
(% Place back into full-length matrix) s
5 632 M
(out\(isGood, :\) = temp;) s
5 610 M
(% Apply spin-up) s
5 599 M
(if spin_up > 0) s
5 588 M
(    out\(1:spin_up,:\) = NaN;) s
5 577 M
(end) s
5 555 M
(end) s
_R
S
%%Trailer
%%Pages: 7
%%DocumentNeededResources: font Courier-Bold Courier 
%%EOF
